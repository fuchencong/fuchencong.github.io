<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/fuchencong.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/fuchencong.github.io/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/fuchencong.github.io/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/fuchencong.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/fuchencong.github.io/css/main.css">


<link rel="stylesheet" href="/fuchencong.github.io/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fuchencong.github.io","root":"/fuchencong.github.io/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="可迭代对象及其相关的迭代器是 ES6 的一个特性，数组（包括 Typed Array）、字符串、Set 对象和 Map 对象都是可迭代的。这意味着可以通过 for&#x2F;of 循环来迭代它们，... 运算符能够扩展 可迭代对象，迭代器可以用于结构赋值。而且有些接收 Array 对象的内置函数&#x2F;构造函数也可以接收任意迭代器。 本章解释迭代器的原理，并展示如何创建可迭代的数据结构。理解迭代后，再学习生成器，">
<meta property="og:type" content="article">
<meta property="og:title" content="JavaScript 权威指南 12：迭代器与生成器">
<meta property="og:url" content="https://fuchencong.github.io/fuchencong.github.io/2025/01/19/javascript-guide-12/index.html">
<meta property="og:site_name" content="fuchencong">
<meta property="og:description" content="可迭代对象及其相关的迭代器是 ES6 的一个特性，数组（包括 Typed Array）、字符串、Set 对象和 Map 对象都是可迭代的。这意味着可以通过 for&#x2F;of 循环来迭代它们，... 运算符能够扩展 可迭代对象，迭代器可以用于结构赋值。而且有些接收 Array 对象的内置函数&#x2F;构造函数也可以接收任意迭代器。 本章解释迭代器的原理，并展示如何创建可迭代的数据结构。理解迭代后，再学习生成器，">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2025-01-19T07:00:52.000Z">
<meta property="article:modified_time" content="2025-06-13T07:03:07.096Z">
<meta property="article:author" content="fuchencong">
<meta property="article:tag" content="前端">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://fuchencong.github.io/fuchencong.github.io/2025/01/19/javascript-guide-12/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>JavaScript 权威指南 12：迭代器与生成器 | fuchencong</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/fuchencong.github.io/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">fuchencong</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">The way I am</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/fuchencong.github.io/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/fuchencong.github.io/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/fuchencong.github.io/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/fuchencong.github.io/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/fuchencong.github.io/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fuchencong.github.io/fuchencong.github.io/2025/01/19/javascript-guide-12/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/fuchencong.github.io/images/logo.jpeg">
      <meta itemprop="name" content="fuchencong">
      <meta itemprop="description" content="Having dreams is what makes life tolerable.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fuchencong">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          JavaScript 权威指南 12：迭代器与生成器
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2025-01-19 15:00:52" itemprop="dateCreated datePublished" datetime="2025-01-19T15:00:52+08:00">2025-01-19</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/fuchencong.github.io/categories/%E5%89%8D%E7%AB%AF/" itemprop="url" rel="index"><span itemprop="name">前端</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>可迭代对象及其相关的迭代器是 ES6 的一个特性，数组（包括 Typed Array）、字符串、Set 对象和 Map 对象都是可迭代的。这意味着可以通过 <code>for/of</code> 循环来迭代它们，<code>...</code> 运算符能够扩展 <code>可迭代对象</code>，迭代器可以用于结构赋值。而且有些接收 Array 对象的内置函数/构造函数也可以接收任意迭代器。</p>
<p>本章解释迭代器的原理，并展示如何创建可迭代的数据结构。理解迭代后，再学习生成器，它是 ES6 的一个新特性，用于简化迭代器的创建。</p>
<span id="more"></span>
<h2 id="迭代器原理"><a class="markdownIt-Anchor" href="#迭代器原理"></a> 迭代器原理</h2>
<p>要理解 JavaScript 中的迭代，必须理解 3 个不同的类型：</p>
<ul>
<li>首先是可迭代对象，类似于 Array、Set、Map，都是可以迭代的</li>
<li>其次是迭代器对象，用于执行迭代</li>
<li>最后是迭代结果对象，保存每次迭代的结果</li>
</ul>
<p>具体来说：</p>
<ul>
<li><code>可迭代对象</code> 是指任何具有特定迭代器方法的对象，且该方法返回 <code>迭代器对象</code></li>
<li><code>迭代器对象</code> 指的是任何具有 <code>next()</code> 方法的对象，且该 <code>next()</code> 方法返回 <code>迭代结果对象</code></li>
<li><code>迭代结果对象</code> 是具有属性 <code>value</code> 和 <code>done</code> 的对象</li>
</ul>
<p><strong>要迭代一个 <code>可迭代对象</code>，首先要调用其迭代器方法获得一个 <code>迭代器对象</code>。然后，重复调用这个 <code>迭代器对象</code> 的 <code>next()</code> 方法，直至返回 done 属性为 true 的迭代结果对象</strong>。</p>
<p>可迭代对象的迭代器方法没有使用惯用名称，而是使用了符号 <code>Symbol.iterator</code> 作为名字。下面展示了可迭代对象的迭代过程：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> iterable = [<span class="number">99</span>, <span class="number">100</span>];</span><br><span class="line"><span class="keyword">let</span> iterator = iterable[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]();</span><br><span class="line"></span><br><span class="line"><span class="comment">// =&gt; 99</span></span><br><span class="line"><span class="comment">// =&gt; 100</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> result = iterator.<span class="title function_">next</span>(); !result.<span class="property">done</span>; result = iterator.<span class="title function_">next</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result.<span class="property">value</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>特别地，内置可迭代数据类型的迭代器对象本身也是可迭代的（即迭代器对象本身也具有名为 <code>Symbol.iterator</code> 的方法，返回它们自己）：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">let</span> list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">&gt; <span class="keyword">let</span> iter = list[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]()</span><br><span class="line">&gt; iter === iter[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]()</span><br><span class="line"><span class="literal">true</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="keyword">let</span> head = iter.<span class="title function_">next</span>()</span><br><span class="line">&gt; head.<span class="property">value</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line">&gt; [...iter]</span><br><span class="line">[ <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span> ]</span><br></pre></td></tr></table></figure>
<h2 id="实现可迭代对象"><a class="markdownIt-Anchor" href="#实现可迭代对象"></a> 实现可迭代对象</h2>
<p>在 ES6 中，可迭代对象非常重要。因此，只要你的数据类型表示某种可迭代的结构，就应该考虑把它们实现为可迭代对象。</p>
<ul>
<li>为了让类可迭代，必须实现一个名为 <code>Symbol.iterator</code> 的方法。这个方法必须返回一个迭代器对象</li>
<li>迭代器对象必须有一个 <code>next()</code> 方法，而这个 <code>next()</code> 方法必须返回一个迭代结果对象，该对象有一个 value 属性和/或一个布尔值 done 属性</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Range</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"><span class="keyword">from</span>, to</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">from</span> = <span class="keyword">from</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">to</span> = to;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">has</span>(<span class="params">x</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">typeof</span> x === <span class="string">&quot;number&quot;</span> &amp;&amp; <span class="variable language_">this</span>.<span class="property">from</span> &lt;= x &amp;&amp; x &lt;= <span class="variable language_">this</span>.<span class="property">to</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">toString</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`&#123; x | <span class="subst">$&#123;<span class="variable language_">this</span>.<span class="keyword">from</span>&#125;</span> &lt;= x &lt;= <span class="subst">$&#123;<span class="variable language_">this</span>.to&#125;</span> &#125;`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() &#123;</span><br><span class="line">    <span class="keyword">let</span> next = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="variable language_">this</span>.<span class="property">from</span>);</span><br><span class="line">    <span class="keyword">let</span> last = <span class="variable language_">this</span>.<span class="property">to</span>;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> (next &lt;= last) ? &#123;<span class="attr">value</span>: next++&#125; : &#123;<span class="attr">done</span>: <span class="literal">true</span>&#125;;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 让迭代器本身也是可迭代的</span></span><br><span class="line">      [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() &#123; <span class="keyword">return</span> <span class="variable language_">this</span>; &#125;,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> x <span class="keyword">of</span> <span class="keyword">new</span> <span class="title class_">Range</span>(<span class="number">1</span>, <span class="number">10</span>)) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(...<span class="keyword">new</span> <span class="title class_">Range</span>(-<span class="number">2</span>, <span class="number">2</span>));</span><br></pre></td></tr></table></figure>
<p>除了可以把类变成可迭代的类之外，定义返回可迭代值的函数也很有用。如下是一个示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">map</span>(<span class="params">iterable, f</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> iterator = iterable[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]();</span><br><span class="line">  <span class="comment">// 返回的对象是既是一个迭代器对象，也是一个可迭代对象</span></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    [<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() &#123; <span class="keyword">return</span> <span class="variable language_">this</span>; &#125;,</span><br><span class="line"></span><br><span class="line">    <span class="title function_">next</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> v = iterator.<span class="title function_">next</span>();</span><br><span class="line">      <span class="keyword">if</span> (v.<span class="property">done</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">value</span>: <span class="title function_">f</span>(v.<span class="property">value</span>)&#125;;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...<span class="title function_">map</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="function"><span class="params">x</span> =&gt;</span> x * <span class="number">2</span>)]);</span><br></pre></td></tr></table></figure>
<p><strong>可迭代对象与迭代器有一个重要的特点，即它们天性懒惰：如果计算下一个值需要一定的计算量，则相应计算会推迟到实际需要下一个值的时候再发生</strong>。</p>
<h3 id="关闭迭代器方法return-方法"><a class="markdownIt-Anchor" href="#关闭迭代器方法return-方法"></a> <code>关闭</code>迭代器方法：<code>return()</code> 方法</h3>
<p>除了 <code>next()</code> 方法，迭代器对象还可以实现 <code>return()</code> 方法：</p>
<ul>
<li>如果迭代在 next() 返回 done 属性为 true 的迭代结果之前停止（最常见的原因是通过 break 语句提前退出 for/of 循环），那么解释器就会检查迭代器对象是否有 <code>return()</code> 方法</li>
<li>如果有，解释器就会调用它（不传参数）​，让迭代器有机会关闭文件、释放内存，或者做一些其他清理工作</li>
<li>这个 return() 方法必须返回一个迭代器结果对象。这个对象的属性会被忽略，但返回非对象值会导致报错</li>
</ul>
<h2 id="生成器"><a class="markdownIt-Anchor" href="#生成器"></a> 生成器</h2>
<p>生成器是一种使用强大的新 ES6 语法定义的迭代器，特别适合要迭代的值不是某个数据结构的元素，而是计算结果的场景。生成器极大地简化了迭代器的创建。</p>
<p>要创建生成器，首先必须定义一个生成器函数。生成器函数在语法上类似常规的 <code>JavaScript</code> 函数，但使用的关键字是 <code>function*</code> 而非 <code>function</code>。</p>
<ul>
<li>调用 <code>生成器函数</code> 并不会实际执行函数体，而是返回一个 <code>生成器</code>。这个生成器是一个迭代器</li>
<li>调用生成器的 <code>next()</code> 方法会导致生成器函数的函数体从头（或从当前位置）开始执行，直至遇见一个 <code>yield</code> 语句</li>
<li>yield 是 ES6 的新特性，类似于 return 语句。yield 语句的值会成为调用迭代器的 next() 方法的返回值</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 生成器函数的定义</span></span><br><span class="line"><span class="keyword">function</span>* <span class="title function_">oneDigitPrimes</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">7</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 调用生成器函数得到生成器</span></span><br><span class="line"><span class="keyword">let</span> primes = <span class="title function_">oneDigitPrimes</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成器既是迭代器，也是可迭代对象，它的迭代器方法返回本身</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(primes[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() === primes);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 生成器是迭代器</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(primes.<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(primes.<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(primes.<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(primes.<span class="title function_">next</span>().<span class="property">value</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(primes.<span class="title function_">next</span>().<span class="property">done</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...<span class="title function_">oneDigitPrimes</span>()]);</span><br></pre></td></tr></table></figure>
<p>与常规函数一样，也可以使用表达式定义生成器。同样，只要在 function 关键字前面加个星号即可：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> seq = <span class="keyword">function</span>*(<span class="keyword">from</span>, to) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="keyword">from</span>; i &lt;= to; i++) <span class="keyword">yield</span> i;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">[...<span class="title function_">seq</span>(<span class="number">3</span>, <span class="number">5</span>)]</span><br></pre></td></tr></table></figure>
<p>在类和对象字面量中，定义方法时可以使用简写形式，省略 function 关键字。在这种情况下定义生成器，只要在应该出现 function 关键字的地方（如果用的话）加一个星号：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o = &#123;</span><br><span class="line">  <span class="attr">x</span>:<span class="number">1</span>, <span class="attr">y</span>:<span class="number">2</span>, <span class="attr">z</span>:<span class="number">3</span>,</span><br><span class="line"></span><br><span class="line">  *<span class="title function_">g</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="title class_">Object</span>.<span class="title function_">keys</span>(<span class="variable language_">this</span>)) &#123;</span><br><span class="line">      <span class="keyword">yield</span> key;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...o.<span class="title function_">g</span>()]); <span class="comment">//=&gt; [ &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;g&#x27; ]</span></span><br></pre></td></tr></table></figure>
<p><strong>不能使用箭头函数语法定义生成器函数</strong>。</p>
<p>生成器在定义可迭代类时特别有用，例如上面的 Range 示例，其 <code>[Symbol.iterator]</code> 方法可以改写为生成器函数：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">*[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]() &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> x = <span class="title class_">Math</span>.<span class="title function_">ceil</span>(<span class="variable language_">this</span>.<span class="property">from</span>); x &lt;= <span class="variable language_">this</span>.<span class="property">to</span>; x++) &#123;</span><br><span class="line">        <span class="keyword">yield</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如下是一个更复杂的生成器函数示例，它可以交替回送多个可迭代对象的元素：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">zip</span>(<span class="params">...iterables</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> iterators = iterables.<span class="title function_">map</span>(<span class="function"><span class="params">i</span> =&gt;</span> i[<span class="title class_">Symbol</span>.<span class="property">iterator</span>]());</span><br><span class="line">  <span class="keyword">let</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (iterators.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (index &gt;= iterators.<span class="property">length</span>) &#123;</span><br><span class="line">      index = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> item = iterators[index].<span class="title function_">next</span>();</span><br><span class="line">    <span class="keyword">if</span> (item.<span class="property">done</span>) &#123;</span><br><span class="line">      iterators.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="keyword">yield</span> item.<span class="property">value</span>;</span><br><span class="line">      index++;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// [</span></span><br><span class="line"><span class="comment">//   1,    &#x27;ab&#x27;, &#x27;u&#x27;, 2,</span></span><br><span class="line"><span class="comment">//   &#x27;cd&#x27;, &#x27;v&#x27;,  3,   &#x27;w&#x27;,</span></span><br><span class="line"><span class="comment">//   &#x27;x&#x27;,  &#x27;y&#x27;,  &#x27;z&#x27;</span></span><br><span class="line"><span class="comment">// ]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...<span class="title function_">zip</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="string">&quot;ab&quot;</span>, <span class="string">&quot;cd&quot;</span>], <span class="string">&quot;uvwxyz&quot;</span>)]);</span><br></pre></td></tr></table></figure>
<h3 id="yield-与递归生成器"><a class="markdownIt-Anchor" href="#yield-与递归生成器"></a> yield* 与递归生成器</h3>
<p>有时候我们有如下需求，在生成器函数中回送其他可迭代对象元素：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">sequence</span>(<span class="params">...iterables</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> iterable <span class="keyword">of</span> iterables) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> iterable) &#123;</span><br><span class="line">      <span class="keyword">yield</span> item;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...<span class="title function_">sequence</span>([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], <span class="string">&quot;abc&quot;</span>)]) <span class="comment">//=&gt;[ 1, 2, 3, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27; ]</span></span><br></pre></td></tr></table></figure>
<p>这种在生成器函数中回送其他可迭代对象元素的操作很常见，所以 ES6 为它定义了特殊语法。<code>yield*</code> 关键字与 yield 类似，<strong>但它不是只回送一个值，而是迭代可迭代对象并回送得到的每个值</strong>。所以上述代码可以简化为：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">sequence</span>(<span class="params">...iterables</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> iterable <span class="keyword">of</span> iterables) &#123;</span><br><span class="line">    <span class="keyword">yield</span>* iterable;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意，<code>yield</code> 和 <code>yield*</code> 只能在生成器函数中使用，而箭头函数不能定义成生成器函数，因此箭头函数中不能出现 yield。</p>
<p><code>yield*</code> 可以用来迭代任何可迭代对象，包括通过生成器实现的。这意味着使用 <code>yield*</code> 可以定义递归生成器，利用这个特性可以通过简单的 <code>非递归迭代</code> 遍历 <code>递归定义的树结构</code>。</p>
<h2 id="高级生成器特性"><a class="markdownIt-Anchor" href="#高级生成器特性"></a> 高级生成器特性</h2>
<p>生成器函数最常见的用途是创建迭代器，但生成器的基本特性是可以暂停计算，回送中间结果，然后在某个时刻再恢复计算，这意味着生成器拥有超越迭代器的特性。</p>
<h3 id="生成器函数的返回值"><a class="markdownIt-Anchor" href="#生成器函数的返回值"></a> 生成器函数的返回值</h3>
<p>与其他函数一样，生成器函数也可以返回值（通过 return 返回值）。对于迭代器/生成器而言，其 <code>next()</code> 返回迭代结果对象，通常：</p>
<ul>
<li>如果 value 属性有定义，则 done 属性未定义或者为 false</li>
<li>如果 done 是 true，那么 value 属性就是未定义的</li>
</ul>
<p>但是当生成器返回值时，最后一次调用 next() 返回的对象 value 和 done 都有定义：<strong>value 是生成器返回的值，done 是 true（表示没有可迭代的值了）​</strong>。</p>
<p>最后这个值会被 <code>for/of</code> 循环和扩展操作符忽略（因为 done 为 true），但手工迭代时可以通过显式调用 <code>next()</code> 得到：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> *<span class="title function_">oneAddDone</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;done&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>([...<span class="title function_">oneAddDone</span>()]); <span class="comment">// =&gt; [1]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> generator = <span class="title function_">oneAddDone</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generator.<span class="title function_">next</span>()); <span class="comment">// =&gt; &#123; value: 1, done: false &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generator.<span class="title function_">next</span>()); <span class="comment">// =&gt; &#123; value: &#x27;done&#x27;, done: true &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(generator.<span class="title function_">next</span>()); <span class="comment">// =&gt; &#123; value: undefined, done: true &#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="yield-表达式的值"><a class="markdownIt-Anchor" href="#yield-表达式的值"></a> yield 表达式的值</h3>
<p>事实上，yield是一个表达式（回送表达式）​，它可以也可以有值。</p>
<ul>
<li>调用生成器的 <code>next()</code> 方法时，生成器函数会一直运行直到到达一个 yield 表达式</li>
<li>yield 关键字后面的表达式会被求值，该值成为 <code>next()</code> 调用的返回值。此时，生成器函数就在求值 <code>yield 表达式</code> 的中途停了下来</li>
<li>下一次调用生成器的 next() 方法时，<strong>传给 <code>next()</code> 的参数会变成暂停的 yield 表达式的值</strong></li>
</ul>
<p>如下是一个说明性质的示例：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">smallNumbers</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;next() 1th invoked, argument discard&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> y1 = <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;next() 2th invoked, argument &quot;</span>, y1);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> y2 = <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;next() 3th invoked, argument &quot;</span>, y2);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> y3 = <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;next() 4th invoked, argument &quot;</span>, y3);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">smallNumbers</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;generator created&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> n1 = g.<span class="title function_">next</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;generator yield&quot;</span>, n1.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> n2 = g.<span class="title function_">next</span>(<span class="string">&quot;b&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;generator yield&quot;</span>, n2.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> n3 = g.<span class="title function_">next</span>(<span class="string">&quot;c&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;generator yield&quot;</span>, n3.<span class="property">value</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> n4 = g.<span class="title function_">next</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;generator return&quot;</span>, n4.<span class="property">value</span>);</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">generator created</span><br><span class="line"><span class="title function_">next</span>() 1th invoked, argument discard</span><br><span class="line">generator <span class="keyword">yield</span> <span class="number">1</span></span><br><span class="line"><span class="title function_">next</span>() 2th invoked, argument  b</span><br><span class="line">generator <span class="keyword">yield</span> <span class="number">2</span></span><br><span class="line"><span class="title function_">next</span>() 3th invoked, argument  c</span><br><span class="line">generator <span class="keyword">yield</span> <span class="number">3</span></span><br><span class="line"><span class="title function_">next</span>() 4th invoked, argument  d</span><br><span class="line">generator <span class="keyword">return</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>尤其要注意，注意以上代码是不对称的。<strong>第一次调用 <code>next()</code> 启动生成器，但传入的值无法在生成器中访问到</strong>。</p>
<h3 id="生成器的-return-和-throw-方法"><a class="markdownIt-Anchor" href="#生成器的-return-和-throw-方法"></a> 生成器的 return() 和 throw() 方法</h3>
<p>综上我们得知，我们可以接收生成器回送或返回的值。同时，也可以通过生成器的 <code>next()</code> 方法给运行中的生成器传值。</p>
<p>除了通过 <code>next()</code> 为生成器提供输入之外，还可以调用它的 <code>return()</code> 和 <code>throw()</code> 方法，改变生成器的控制流。顾名思义，在生成器上调用这两个方法会导致它返回值或抛出异常，就像生成器函数中的一下条语句是 return 或 throw 一样。</p>
<p>之前说过，对于迭代器，如果迭代器定义了 <code>return()</code> 方法且迭代提前停止，解释器会自动调用 它的 <code>return()</code> 方法，从而让迭代器有机会关闭文件或做一些其他清理工作。对生成器而言：</p>
<ul>
<li>我们无法定义这样一个 <code>return()</code> 方法来做清理工作，但可以在生成器函数中使用 <code>try/finally</code> 语句，保证生成器返回时（在 finally 块中）做一些必要的清理工作</li>
<li>在强制生成器返回时，生成器内置的 <code>return()</code> 方法可以保证这些清理代码运行</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span>* <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">yield</span> <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;finally block exec&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="comment">// finally block exec</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> <span class="title function_">test</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// finally block exec</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> <span class="title function_">test</span>()) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">  <span class="keyword">if</span> (v == <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">// finally block exec</span></span><br><span class="line"><span class="keyword">let</span> g = <span class="title function_">test</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> v <span class="keyword">of</span> g) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(v);</span><br><span class="line">  <span class="keyword">if</span> (v == <span class="number">2</span>) &#123;</span><br><span class="line">    g.<span class="keyword">return</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>生成器的 <code>throw()</code> 方法为我们提供了（以异常形式）向生成器发送任意信号的途径。调用 <code>throw()</code> 方法就会导致生成器函数抛出异常。如果生成器函数中有适当的异常处理代码，则这个异常就不一定致命，而是可以成为一种改变生成器行为的手段。</p>
<h3 id="生成器小结"><a class="markdownIt-Anchor" href="#生成器小结"></a> 生成器小结</h3>
<p>生成器是一种非常强大的通用控制结构，它赋予我们通过 yield 暂停计算并在未来某个时刻以任意输入值重新启动计算的能力：</p>
<ul>
<li>可以使用生成器在单线程 JavaScript 代码中创建某种协作线程系统</li>
<li>也可以利用生成器来掩盖程序中的异步逻辑，这样尽管某些函数调用依赖网络事件，实际上是异步的，但代码看起来还是顺序的、同步的</li>
</ul>
<p>利用生成器的代码通常比较晦涩，JavaScript 专门新增了 async/await 语法（后续介绍），来简化生成器的这种用法。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/fuchencong.github.io/tags/%E5%89%8D%E7%AB%AF/" rel="tag"># 前端</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/fuchencong.github.io/2025/01/20/javascript-guide-13/" rel="prev" title="JavaScript 权威指南 13：异步 JavaScript">
      <i class="fa fa-chevron-left"></i> JavaScript 权威指南 13：异步 JavaScript
    </a></div>
      <div class="post-nav-item">
    <a href="/fuchencong.github.io/2025/01/18/javascript-guide-11/" rel="next" title="JavaScript 权威指南 11：JavaScript 标准库">
      JavaScript 权威指南 11：JavaScript 标准库 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%8E%9F%E7%90%86"><span class="nav-number">1.</span> <span class="nav-text"> 迭代器原理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%AF%B9%E8%B1%A1"><span class="nav-number">2.</span> <span class="nav-text"> 实现可迭代对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B3%E9%97%AD%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%96%B9%E6%B3%95return-%E6%96%B9%E6%B3%95"><span class="nav-number">2.1.</span> <span class="nav-text"> 关闭迭代器方法：return() 方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-number">3.</span> <span class="nav-text"> 生成器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#yield-%E4%B8%8E%E9%80%92%E5%BD%92%E7%94%9F%E6%88%90%E5%99%A8"><span class="nav-number">3.1.</span> <span class="nav-text"> yield* 与递归生成器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E7%94%9F%E6%88%90%E5%99%A8%E7%89%B9%E6%80%A7"><span class="nav-number">4.</span> <span class="nav-text"> 高级生成器特性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%87%BD%E6%95%B0%E7%9A%84%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="nav-number">4.1.</span> <span class="nav-text"> 生成器函数的返回值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#yield-%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E5%80%BC"><span class="nav-number">4.2.</span> <span class="nav-text"> yield 表达式的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E7%9A%84-return-%E5%92%8C-throw-%E6%96%B9%E6%B3%95"><span class="nav-number">4.3.</span> <span class="nav-text"> 生成器的 return() 和 throw() 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%B0%8F%E7%BB%93"><span class="nav-number">4.4.</span> <span class="nav-text"> 生成器小结</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fuchencong"
      src="/fuchencong.github.io/images/logo.jpeg">
  <p class="site-author-name" itemprop="name">fuchencong</p>
  <div class="site-description" itemprop="description">Having dreams is what makes life tolerable.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/fuchencong.github.io/archives/">
        
          <span class="site-state-item-count">215</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/fuchencong.github.io/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/fuchencong.github.io/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fuchencong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fuchencong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fuchencong@163.com" title="E-Mail → mailto:fuchencong@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fuchencong</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/fuchencong.github.io/lib/anime.min.js"></script>
  <script src="/fuchencong.github.io/lib/velocity/velocity.min.js"></script>
  <script src="/fuchencong.github.io/lib/velocity/velocity.ui.min.js"></script>

<script src="/fuchencong.github.io/js/utils.js"></script>

<script src="/fuchencong.github.io/js/motion.js"></script>


<script src="/fuchencong.github.io/js/schemes/muse.js"></script>


<script src="/fuchencong.github.io/js/next-boot.js"></script>




  















  

  
      
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">


  

</body>
</html>
