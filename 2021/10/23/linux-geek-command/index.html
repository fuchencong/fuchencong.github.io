<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/fuchencong.github.io/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/fuchencong.github.io/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/fuchencong.github.io/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/fuchencong.github.io/images/logo.svg" color="#222">

<link rel="stylesheet" href="/fuchencong.github.io/css/main.css">


<link rel="stylesheet" href="/fuchencong.github.io/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fuchencong.github.io","root":"/fuchencong.github.io/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="以前看过一部电影 《社交网络》，讲述的是天才程序员扎克伯格在哈佛创建 Facebook 的故事。电影中有一个场景：扎克伯格一边喝着啤酒，一边在自己笔记本电脑上通过一系列 hacking 操作，利用 wget、perl、emacs 等工具收集各个学院里女生的照片放在自己的网站上供大家浏览，这也是 Facebook 的雏形。完成所有工作后，男主吃着零食，淡定地坐在电脑前监视网站的流量。当时被这个场景深">
<meta property="og:type" content="article">
<meta property="og:title" content="linux_geek_command">
<meta property="og:url" content="https://fuchencong.github.io/fuchencong.github.io/2021/10/23/linux-geek-command/index.html">
<meta property="og:site_name" content="fuchencong">
<meta property="og:description" content="以前看过一部电影 《社交网络》，讲述的是天才程序员扎克伯格在哈佛创建 Facebook 的故事。电影中有一个场景：扎克伯格一边喝着啤酒，一边在自己笔记本电脑上通过一系列 hacking 操作，利用 wget、perl、emacs 等工具收集各个学院里女生的照片放在自己的网站上供大家浏览，这也是 Facebook 的雏形。完成所有工作后，男主吃着零食，淡定地坐在电脑前监视网站的流量。当时被这个场景深">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-10-23T09:33:01.000Z">
<meta property="article:modified_time" content="2022-08-25T12:04:03.766Z">
<meta property="article:author" content="fuchencong">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://fuchencong.github.io/fuchencong.github.io/2021/10/23/linux-geek-command/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>linux_geek_command | fuchencong</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/fuchencong.github.io/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">fuchencong</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">The way I am</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/fuchencong.github.io/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/fuchencong.github.io/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/fuchencong.github.io/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/fuchencong.github.io/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/fuchencong.github.io/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fuchencong.github.io/fuchencong.github.io/2021/10/23/linux-geek-command/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/fuchencong.github.io/images/logo.jpeg">
      <meta itemprop="name" content="fuchencong">
      <meta itemprop="description" content="Having dreams is what makes life tolerable.">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fuchencong">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          linux_geek_command
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-10-23 17:33:01" itemprop="dateCreated datePublished" datetime="2021-10-23T17:33:01+08:00">2021-10-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/fuchencong.github.io/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>以前看过一部电影 《社交网络》，讲述的是天才程序员扎克伯格在哈佛创建 Facebook 的故事。电影中有一个场景：扎克伯格一边喝着啤酒，一边在自己笔记本电脑上通过一系列 hacking 操作，利用 wget、perl、emacs 等工具收集各个学院里女生的照片放在自己的网站上供大家浏览，这也是 Facebook 的雏形。完成所有工作后，男主吃着零食，淡定地坐在电脑前监视网站的流量。当时被这个场景深深震撼到了，这才是一名 geeker 应该有的样子。<a target="_blank" rel="noopener" href="http://video.tudou.com/v/XMTUwMDk2MzMxMg==.html">这里</a>是这段视频的链接。</p>
<p>作为一名主要工作在 Linux 系统上的程序员，如何更加高效地使用 Linux 命令行，更加 geek 地操作 Bash 一直是我学习的目标。其实网络上也有很多关于这方面的资源：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.commandlinefu.com/commands/browse/sort-by-votes">commandlinefu.com</a>：记录了各种各样的命令行技巧，可供大家讨论、投票</li>
<li><a target="_blank" rel="noopener" href="http://www.bashoneliners.com/">Bash One-Lines</a>：在一行命令中完成复杂任务</li>
</ul>
<p>本篇文章主要基于 <a target="_blank" rel="noopener" href="https://www.linuxtrainingacademy.com/command-line-kung-fu/">《Command Line Kong Fu》</a> 一书，对其中每个实例都进行了测试，同时也提供更详细的解释。这篇文章也将会不停增长，用于积累学习到的其他技巧。</p>
<p>Let the hacking begin.</p>
<span id="more"></span>

<h2 id="Shell-历史"><a href="#Shell-历史" class="headerlink" title="Shell 历史"></a>Shell 历史</h2><h3 id="使用-root-账户运行上一个命令"><a href="#使用-root-账户运行上一个命令" class="headerlink" title="使用 root 账户运行上一个命令"></a>使用 root 账户运行上一个命令</h3><h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ sudo !!</span><br><span class="line">或者</span><br><span class="line">$ su -c <span class="string">&quot;!!&quot;</span></span><br></pre></td></tr></table></figure>

<h4 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h4><p>当你运行一个命令失败，失败原因是由于需要 root 权限，此时可以通过以上方式快速使用 root 用户重新运行上一个命令。</p>
<h4 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost ~]$ useradd <span class="built_in">test</span></span><br><span class="line">-bash: /usr/sbin/useradd: Permission denied</span><br><span class="line">[fuchencong@localhost ~]$ sudo !!</span><br><span class="line">sudo useradd <span class="built_in">test</span></span><br><span class="line">[fuchencong@localhost ~]$ <span class="built_in">id</span> <span class="built_in">test</span></span><br><span class="line">uid=1002(<span class="built_in">test</span>) gid=1002(<span class="built_in">test</span>) <span class="built_in">groups</span>=1002(<span class="built_in">test</span>)</span><br><span class="line">[fuchencong@localhost ~]$ userdel -r <span class="built_in">test</span></span><br><span class="line">-bash: /usr/sbin/userdel: Permission denied</span><br><span class="line">[fuchencong@localhost ~]$ sudo !!</span><br><span class="line">sudo userdel -r <span class="built_in">test</span></span><br><span class="line">[fuchencong@localhost ~]$ <span class="built_in">id</span> <span class="built_in">test</span></span><br><span class="line"><span class="built_in">id</span>: <span class="built_in">test</span>: no such user</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost ~]$ useradd test2</span><br><span class="line">-bash: /usr/sbin/useradd: Permission denied</span><br><span class="line">[fuchencong@localhost ~]$ su -c <span class="string">&quot;useradd test2&quot;</span></span><br><span class="line">Password:</span><br><span class="line">[fuchencong@localhost ~]$ <span class="built_in">id</span> test2</span><br><span class="line">uid=1002(test2) gid=1002(test2) <span class="built_in">groups</span>=1002(test2)</span><br></pre></td></tr></table></figure>

<h4 id="解释"><a href="#解释" class="headerlink" title="解释"></a>解释</h4><p>这里所使用的 感叹号 语法被称为事件指示器。一个事件指示器可以引用你 shell 历史中的一个命令，连续两个感叹号 !! 可以重复最近的一个命令。</p>
<h3 id="重用最近的以给定字符串开头的命令"><a href="#重用最近的以给定字符串开头的命令" class="headerlink" title="重用最近的以给定字符串开头的命令"></a>重用最近的以给定字符串开头的命令</h3><h4 id="命令-1"><a href="#命令-1" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ !&lt;string&gt;</span><br></pre></td></tr></table></figure>

<h4 id="作用-1"><a href="#作用-1" class="headerlink" title="作用"></a>作用</h4><p>这是事件指示器的另一个例子，通过运行 !<string> 来运行最近一个以 <string> 字符串开头的命令。字符串的长度可以只有一个字符，也可以有多个字符，只要能够唯一地指定你想要运行的命令即可。</p>
<h4 id="例子-1"><a href="#例子-1" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost ~]$ <span class="built_in">who</span></span><br><span class="line">root     pts/0        2019-03-28 11:41 (192.168.204.1)</span><br><span class="line">[fuchencong@localhost ~]$ w</span><br><span class="line"> 11:59:20 up 33 min,  1 user,  load average: 0.15, 0.09, 0.06</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     pts/0    192.168.204.1    11:41    0.00s  0.04s  0.01s w</span><br><span class="line">[fuchencong@localhost ~]$ !w</span><br><span class="line">w</span><br><span class="line"> 11:59:26 up 33 min,  1 user,  load average: 0.13, 0.09, 0.06</span><br><span class="line">USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT</span><br><span class="line">root     pts/0    192.168.204.1    11:41    6.00s  0.03s  0.00s w</span><br><span class="line">[fuchencong@localhost ~]$ !wh</span><br><span class="line"><span class="built_in">who</span></span><br><span class="line">root     pts/0        2019-03-28 11:41 (192.168.204.1)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost ~]$ ps aux | grep dockerd</span><br><span class="line">root       1569  0.3  7.1 652864 71632 ?        Ssl  11:26   0:07 /usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</span><br><span class="line">fuchenc+   7932  0.0  0.0 112708   976 pts/0    R+   12:03   0:00 grep --color=auto dockerd</span><br><span class="line">[fuchencong@localhost ~]$ sudo service docker stop</span><br><span class="line">Redirecting to /bin/systemctl stop docker.service</span><br><span class="line">[fuchencong@localhost ~]$ !p</span><br><span class="line">ps aux | grep dockerd</span><br><span class="line">fuchenc+   8147  0.0  0.0 112708   976 pts/0    S+   12:04   0:00 grep --color=auto dockerd</span><br></pre></td></tr></table></figure>

<h4 id="解释-1"><a href="#解释-1" class="headerlink" title="解释"></a>解释</h4><p>这也是事件指示器的一种用法。</p>
<h3 id="重用上一个命令的第二个单词（第一个参数）"><a href="#重用上一个命令的第二个单词（第一个参数）" class="headerlink" title="重用上一个命令的第二个单词（第一个参数）"></a>重用上一个命令的第二个单词（第一个参数）</h3><h4 id="命令-2"><a href="#命令-2" class="headerlink" title="命令"></a>命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ !^</span><br></pre></td></tr></table></figure>

<h4 id="作用-2"><a href="#作用-2" class="headerlink" title="作用"></a>作用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">如果需要重用上一个命令的第二个单词（也就是第一个参数），可以使用 !^ 这种单词指示器。</span><br><span class="line"></span><br><span class="line">#### 例子</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">[fuchencong@localhost ~]$ host www.baidu.com 8.8.8.8</span><br><span class="line">Using domain server:</span><br><span class="line">Name: 8.8.8.8</span><br><span class="line">Address: 8.8.8.8#53</span><br><span class="line">Aliases:</span><br><span class="line"></span><br><span class="line">www.baidu.com is an alias for www.a.shifen.com.</span><br><span class="line">www.a.shifen.com is an alias for www.wshifen.com.</span><br><span class="line">www.wshifen.com has address 103.235.46.39</span><br><span class="line"></span><br><span class="line">[fuchencong@localhost ~]$ ping -c 1 !^</span><br><span class="line">ping -c 1 www.baidu.com</span><br><span class="line">PING www.wshifen.com (103.235.46.39) 56(84) bytes of data.</span><br><span class="line">64 bytes from 103.235.46.39 (103.235.46.39): icmp_seq=1 ttl=128 time=73.2 ms</span><br><span class="line"></span><br><span class="line">--- www.wshifen.com ping statistics ---</span><br><span class="line">1 packets transmitted, 1 received, 0% packet loss, time 0ms</span><br><span class="line">rtt min/avg/max/mdev = 73.263/73.263/73.263/0.000 ms</span><br></pre></td></tr></table></figure>

<h4 id="解释-2"><a href="#解释-2" class="headerlink" title="解释"></a>解释</h4><p>命令行中，无论在哪里使用 !^，它都将会被替换为上一个命令的第二个单词。</p>
<h3 id="重用上一个命令的最后一个单词（最后一个参数）"><a href="#重用上一个命令的最后一个单词（最后一个参数）" class="headerlink" title="重用上一个命令的最后一个单词（最后一个参数）"></a>重用上一个命令的最后一个单词（最后一个参数）</h3><h4 id="命令-3"><a href="#命令-3" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ !$</span><br></pre></td></tr></table></figure>

<h4 id="作用-3"><a href="#作用-3" class="headerlink" title="作用"></a>作用</h4><p>如果需要重用上一个命令的最后一个单词（也就是最后一个参数），可以使用 !$ 这种单词指示器。</p>
<h4 id="例子-2"><a href="#例子-2" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost ~]$ <span class="built_in">ls</span> -l /etc/networks</span><br><span class="line">-rw-r--r--. 1 root root 58 Apr 11  2018 /etc/networks</span><br><span class="line">[fuchencong@localhost ~]$ <span class="built_in">cat</span> !$</span><br><span class="line"><span class="built_in">cat</span> /etc/networks</span><br><span class="line">default 0.0.0.0</span><br><span class="line">loopback 127.0.0.0</span><br><span class="line">link-local 169.254.0.0</span><br><span class="line">[fuchencong@localhost ~]$ <span class="built_in">ls</span> -l /home/fuchencong/</span><br><span class="line">total 0</span><br><span class="line">[fuchencong@localhost ~]$ <span class="built_in">du</span> -sh !$</span><br><span class="line"><span class="built_in">du</span> -sh /home/fuchencong/</span><br><span class="line">20K	/home/fuchencong/</span><br></pre></td></tr></table></figure>

<h4 id="解释-3"><a href="#解释-3" class="headerlink" title="解释"></a>解释</h4><p>命令行中，无论在哪里使用 !$，它都将会被替换为上一个命令的最后一个单词。</p>
<h3 id="重用以前某个命令的第-N-个单词"><a href="#重用以前某个命令的第-N-个单词" class="headerlink" title="重用以前某个命令的第 N 个单词"></a>重用以前某个命令的第 N 个单词</h3><h4 id="命令-4"><a href="#命令-4" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ !!:N</span><br><span class="line">$ &lt;event_designator&gt;:&lt;number&gt;</span><br></pre></td></tr></table></figure>

<h4 id="作用-4"><a href="#作用-4" class="headerlink" title="作用"></a>作用</h4><p>!!:N 重用最近一个命令的第 N 个单词，N 是你想获取的单词计数。第一个单词计数为 0，第二个单词计数为 1，依次类推。所以可以认为 0 代表命令本身，1 代表命令的第一个参数，依此类推。</p>
<p><event_designator>:<number> 重用以 <event_designator> 事件指示器所指定命令的第 N 个单词。</p>
<h4 id="例子-3"><a href="#例子-3" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">ls</span> -l file.1 file.2 file.3</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong 0 Mar 28 14:25 file.1</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong 0 Mar 28 14:25 file.2</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong 0 Mar 28 14:25 file.3</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">mv</span> !!:2 dir.1</span><br><span class="line"><span class="built_in">mv</span> file.1 dir.1</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">mv</span> !<span class="built_in">ls</span>:3 dir.2</span><br><span class="line"><span class="built_in">mv</span> file.2 dir.2</span><br></pre></td></tr></table></figure>

<h4 id="解释-4"><a href="#解释-4" class="headerlink" title="解释"></a>解释</h4><p>可以认为，!! 和 <event_designator> 都用于引用相应的命令，而 !<number> 用于引用该命令中第 number 个单词。</p>
<h3 id="重复上一个命令，同时替换某个字符串"><a href="#重复上一个命令，同时替换某个字符串" class="headerlink" title="重复上一个命令，同时替换某个字符串"></a>重复上一个命令，同时替换某个字符串</h3><h4 id="命令-5"><a href="#命令-5" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ^&lt;string1&gt;^&lt;string2&gt;^</span><br></pre></td></tr></table></figure>

<h4 id="作用-5"><a href="#作用-5" class="headerlink" title="作用"></a>作用</h4><p>该命令可以快速修正上一个命令中的拼写错误，从而快速更正上一个命令。如果省略 ^<string2>，则 <string1> 将会从命令中移除。默认，只有命令中的第一个 <string1> 会被替换，如果想替换该命令中的所有 <string1>，则在上述命令末尾加入 :&amp;。</p>
<p>另外，在不使用 :&amp; 时，结尾的 ^ 也可以省略。</p>
<h4 id="例子-4"><a href="#例子-4" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost Chapter_01]$ grpe fuchencong /etc/passwd</span><br><span class="line">-bash: grpe: <span class="built_in">command</span> not found</span><br><span class="line">[fuchencong@localhost Chapter_01]$ ^pe^ep</span><br><span class="line">grep fuchencong /etc/passwd</span><br><span class="line">fuchencong:x:1001:1001::/home/fuchencong:/bin/bash</span><br><span class="line"></span><br><span class="line">[fuchencong@localhost Chapter_01]$ grep rooty /etc/passwd</span><br><span class="line">[fuchencong@localhost Chapter_01]$ ^y</span><br><span class="line">grep root /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">ls</span> -l dir_1 dir_2</span><br><span class="line"><span class="built_in">ls</span>: cannot access dir_1: No such file or directory</span><br><span class="line"><span class="built_in">ls</span>: cannot access dir_2: No such file or directory</span><br><span class="line"></span><br><span class="line">[fuchencong@localhost Chapter_01]$ ^_^.^:&amp;</span><br><span class="line"><span class="built_in">ls</span> -l dir.1 dir.2</span><br><span class="line">dir.1:</span><br><span class="line">total 0</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong 0 Mar 28 14:25 file.1</span><br><span class="line"></span><br><span class="line">dir.2:</span><br><span class="line">total 0</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong 0 Mar 28 14:25 file.2</span><br></pre></td></tr></table></figure>

<h4 id="解释-5"><a href="#解释-5" class="headerlink" title="解释"></a>解释</h4><p>通过这种方式可以快速更正上一个命令的细微错误。</p>
<h3 id="引用当前命令的某个单词"><a href="#引用当前命令的某个单词" class="headerlink" title="引用当前命令的某个单词"></a>引用当前命令的某个单词</h3><h4 id="命令-6"><a href="#命令-6" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ !<span class="comment">#:N</span></span><br></pre></td></tr></table></figure>

<h4 id="作用-6"><a href="#作用-6" class="headerlink" title="作用"></a>作用</h4><p>上述方式引用当前命令的第 N 个单词。同样单词计数从 0 开始，第一个单词计数为 0，第二个单词计数为 1，依此类推。</p>
<h4 id="例子-5"><a href="#例子-5" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">mv</span> test.file new!<span class="comment">#:1</span></span><br><span class="line"><span class="built_in">mv</span> test.file newtest.file</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">ls</span> newtest.file</span><br><span class="line">newtest.file</span><br></pre></td></tr></table></figure>

<h4 id="解释-6"><a href="#解释-6" class="headerlink" title="解释"></a>解释</h4><p>可以认为 !# 事件指示器代表当前命令行，:N 单词指示器指定了第 N 个单词，所以该命令用于引用当前命令的第 N 个单词。</p>
<h3 id="保存当前命令行会话的副本"><a href="#保存当前命令行会话的副本" class="headerlink" title="保存当前命令行会话的副本"></a>保存当前命令行会话的副本</h3><h4 id="命令-7"><a href="#命令-7" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ script</span><br></pre></td></tr></table></figure>

<h4 id="作用-7"><a href="#作用-7" class="headerlink" title="作用"></a>作用</h4><p>如果想将当前命令行会话的所有内容保存为文档，可以使用 script 命令。</p>
<h4 id="例子-6"><a href="#例子-6" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost Chapter_01]$ script</span><br><span class="line">Script started, file is typescript</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">ls</span> -l</span><br><span class="line">total 0</span><br><span class="line">drwxrwxr-x. 2 fuchencong fuchencong 20 Mar 28 14:27 dir.1</span><br><span class="line">drwxrwxr-x. 2 fuchencong fuchencong 20 Mar 28 14:29 dir.2</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong  0 Mar 28 14:25 file.3</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong  0 Mar 29 11:29 newtest.file</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong  0 Mar 29 11:36 typescript</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">rm</span> -rf file.3</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">echo</span> <span class="string">&quot;this is a test for script command&quot;</span></span><br><span class="line">this is a <span class="built_in">test</span> <span class="keyword">for</span> script <span class="built_in">command</span></span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">Script <span class="keyword">done</span>, file is typescript</span><br><span class="line"></span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">cat</span> typescript</span><br><span class="line">Script started on Fri 29 Mar 2019 11:36:53 AM CST</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">ls</span> -l</span><br><span class="line">total 0</span><br><span class="line">drwxrwxr-x. 2 fuchencong fuchencong 20 Mar 28 14:27 dir.1</span><br><span class="line">drwxrwxr-x. 2 fuchencong fuchencong 20 Mar 28 14:29 dir.2</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong  0 Mar 28 14:25 file.3</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong  0 Mar 29 11:29 newtest.file</span><br><span class="line">-rw-rw-r--. 1 fuchencong fuchencong  0 Mar 29 11:36 typescript</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">rm</span> -rf file.3</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">echo</span> <span class="string">&quot;this is a test for script command&quot;</span></span><br><span class="line">this is a <span class="built_in">test</span> <span class="keyword">for</span> script <span class="built_in">command</span></span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">Script <span class="keyword">done</span> on Fri 29 Mar 2019 11:37:26 AM CST</span><br></pre></td></tr></table></figure>

<h4 id="解释-7"><a href="#解释-7" class="headerlink" title="解释"></a>解释</h4><p>script 命令会捕获你终端中打印的一切内容，并将其保存为文档。可以提供一个文件名作为参数，否则默认的保存文件名为 typescript。</p>
<h3 id="找出最常用的命令"><a href="#找出最常用的命令" class="headerlink" title="找出最常用的命令"></a>找出最常用的命令</h3><h4 id="命令-8"><a href="#命令-8" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">history</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="built_in">sort</span> | <span class="built_in">uniq</span> -c | <span class="built_in">sort</span> -rn | <span class="built_in">head</span></span><br></pre></td></tr></table></figure>

<h4 id="作用-8"><a href="#作用-8" class="headerlink" title="作用"></a>作用</h4><p>从 shell 命令历史中获取最常用的 10 个命令。</p>
<h4 id="例子-7"><a href="#例子-7" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">history</span> | awk <span class="string">&#x27;&#123;print $2&#125;&#x27;</span> | <span class="built_in">sort</span> | <span class="built_in">uniq</span> -c | <span class="built_in">sort</span> -rn | <span class="built_in">head</span></span><br><span class="line">     37 <span class="built_in">ls</span></span><br><span class="line">     12 sudo</span><br><span class="line">      9 <span class="built_in">history</span></span><br><span class="line">      8 <span class="built_in">cd</span></span><br><span class="line">      7 <span class="built_in">mv</span></span><br><span class="line">      6 ps</span><br><span class="line">      6 man</span><br><span class="line">      6 <span class="built_in">exit</span></span><br><span class="line">      5 <span class="built_in">mkdir</span></span><br><span class="line">      3 yum</span><br></pre></td></tr></table></figure>

<h4 id="解释-8"><a href="#解释-8" class="headerlink" title="解释"></a>解释</h4><p>history 用于获取命令历史，通过 awk 截取执行的命令。然后通过 sort 进行命令字符串排序，排序完之后就可以通过 uniq 命令去重，同时输出每个命令出现的计数，之后使用 sort 根据计数值的大小进行排序，最后通过 head 命令输出前 10 个计数值最大的命令。</p>
<h3 id="清空命令行历史"><a href="#清空命令行历史" class="headerlink" title="清空命令行历史"></a>清空命令行历史</h3><h4 id="命令-9"><a href="#命令-9" class="headerlink" title="命令"></a>命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">history</span> -c</span><br></pre></td></tr></table></figure>

<h4 id="作用-9"><a href="#作用-9" class="headerlink" title="作用"></a>作用</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用 <span class="built_in">history</span> 命令的 -c 选项来清除命令历史。</span><br></pre></td></tr></table></figure>

<h4 id="例子-8"><a href="#例子-8" class="headerlink" title="例子"></a>例子</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">history</span> | <span class="built_in">head</span> -n 5</span><br><span class="line">    1  <span class="built_in">cd</span> ~</span><br><span class="line">    2  <span class="built_in">ls</span></span><br><span class="line">    3  useradd <span class="built_in">test</span></span><br><span class="line">    4  sudo useradd <span class="built_in">test</span></span><br><span class="line">    5  LS</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">history</span> -c</span><br><span class="line">[fuchencong@localhost Chapter_01]$ <span class="built_in">history</span></span><br><span class="line">    1  <span class="built_in">history</span></span><br></pre></td></tr></table></figure>

<h4 id="解释-9"><a href="#解释-9" class="headerlink" title="解释"></a>解释</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">使用 <span class="built_in">history</span> -c 来清空当前 bash 命令历史。</span><br></pre></td></tr></table></figure>

<h2 id="文本处理和操作"><a href="#文本处理和操作" class="headerlink" title="文本处理和操作"></a>文本处理和操作</h2><p>去除注释和空白行<br>命令<br>1<br>$ grep -E -v “^#|^$” file<br>作用<br>该命令可以只显示 file 文件的非空白行和非注释行（这里的注释行指的是以 # 开头的行）。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[fuchencong@localhost Chapter_02]$ cat test.file<br>this is a test fille</p>
<h1 id="this-is-a-comment-line"><a href="#this-is-a-comment-line" class="headerlink" title="this is a comment line"></a>this is a comment line</h1><p>enf of file.<br>[fuchencong@localhost Chapter_02]$ grep -E -v “^#|^$” test.file<br>this is a test fille<br>enf of file.<br>解释<br>使用 grep 命令进行文本匹配，-E 选项支持使用正则表达式匹配，-v 进行反向匹配，即输出不符合匹配模式的文本行。正则表达式 ^#|^$ 匹配两种文本行：^# 匹配以 # 开头的文本行，^$ 匹配空白行。</p>
<p>使用 Vim 跨网络编辑文件<br>命令<br>1<br>2<br>$ vim scp:&#x2F;&#x2F;remote-host&#x2F;&#x2F;path&#x2F;to&#x2F;file<br>$ vim scp:&#x2F;&#x2F;remote-user@remote-host&#x2F;&#x2F;path&#x2F;to&#x2F;file<br>作用<br>该命令可以使用 vim 编辑远程主机 remote-host 上的指定文件，第二个命令除了指定远程主机 remote-host，还指定了登录用户为 remote-user，如果不指定用户名，则默认为当前执行该命令的用户。</p>
<p>例子<br>1<br>fchencong@contrail-ubm-srx-re3:<del>$ vim scp:&#x2F;&#x2F;cnrd-ngsrx-build08&#x2F;</del>&#x2F;test.file<br>解释<br>scp 指定了跨主机通信的协议。</p>
<p>以表格形式输出内容<br>命令<br>1<br>2<br>$ alias ct&#x3D;’column -t’<br>$ command | ct<br>作用<br>使用 column -t 对 command 命令的输出进行格式化，以表格的形式进行输出。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>[fuchencong@localhost Chapter_02]$ echo -e “one two\nthree four”<br>one two<br>three four<br>[fuchencong@localhost Chapter_02]$ echo -e “one two\nthree four” | ct<br>one    two<br>three  four<br>[fuchencong@localhost Chapter_02]$ mount -t tmpfs<br>tmpfs on &#x2F;dev&#x2F;shm type tmpfs (rw,nosuid,nodev,seclabel)<br>tmpfs on &#x2F;run type tmpfs (rw,nosuid,nodev,seclabel,mode&#x3D;755)<br>tmpfs on &#x2F;sys&#x2F;fs&#x2F;cgroup type tmpfs (ro,nosuid,nodev,noexec,seclabel,mode&#x3D;755)<br>[fuchencong@localhost Chapter_02]$ mount -t tmpfs | ct<br>tmpfs  on  &#x2F;dev&#x2F;shm        type  tmpfs  (rw,nosuid,nodev,seclabel)<br>tmpfs  on  &#x2F;run            type  tmpfs  (rw,nosuid,nodev,seclabel,mode&#x3D;755)<br>tmpfs  on  &#x2F;sys&#x2F;fs&#x2F;cgroup  type  tmpfs  (ro,nosuid,nodev,noexec,seclabel,mode&#x3D;755)<br>解释<br>column 命令用于将输入格式化为多列，-t 选项根据输入内容的列数自动将输入内容格式化为表格形式进行输出。为了便于使用，使用 alias 创建一个命令别名，使用 ct 代替 columnn -t，之后直接使用 ct 对 command 命令的输出进行表格化。</p>
<p>获取每一行的最后一个单词<br>命令<br>1<br>2<br>$ awk ‘{print $NF}’ file<br>$ cat file | awk ‘{print $NF}’<br>作用<br>以上方式可以获取 file 文件中每一行的最后一个单词。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>[fuchencong@localhost Chapter_02]$ awk -F : ‘{print $NF}’ &#x2F;etc&#x2F;passwd | sort -u<br>&#x2F;bin&#x2F;bash<br>&#x2F;bin&#x2F;sync<br>&#x2F;sbin&#x2F;halt<br>&#x2F;sbin&#x2F;nologin<br>[fuchencong@localhost Chapter_02]$ awk -F : ‘{print $1,$NF}’ &#x2F;etc&#x2F;passwd | sort | column -t<br>abrt             &#x2F;sbin&#x2F;nologin<br>adm              &#x2F;sbin&#x2F;nologin<br>bin              &#x2F;sbin&#x2F;nologin<br>daemon           &#x2F;sbin&#x2F;nologin<br>dbus             &#x2F;sbin&#x2F;nologin<br>ftp              &#x2F;sbin&#x2F;nologin<br>fuchencong       &#x2F;bin&#x2F;bash<br>……<br>解释<br>使用 awk 命令的 print 来输出每一行的指定 filed，通过 $FIELD_NUMBER 的方式来指定 field。例如，通过 $1 的方式指定第一列单词，$2 指定第二列，以此类推，使用 $NF 来指定最后一列。默认 awk 使用空格符来划分 field，可以使用 -F 选项指定分隔符字段。</p>
<p>使用 less 命令时获得彩色输出<br>命令<br>1<br>2<br>$ ls –color&#x3D;always | less -R<br>$ grep –color&#x3D;always | less -R<br>作用<br>通过以上方式，即使在使用 less 查看 ls 或 grep 命令的输出时，也可以获得彩色输出形式。</p>
<p>例子<br>1<br>[fuchencong@localhost Chapter_02]$ grep color color.txt | less</p>
<p>1<br>[fuchencong@localhost Chapter_02]$ grep –color&#x3D;always color color.txt | less -R</p>
<p>解释<br>一些 Linux 发行版本会为 ls 和 grep 命令创建命令别名，使其总是设置 —color&#x3D;auto 选项，这导致只有在终端输出结果时才具有颜色高亮，当 ls 或 grep 的结果传递给管道时则省略掉颜色控制符。在我的 CentOS 7 上就是这样：</p>
<p>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_02]$ type ls<br>ls is aliased to <code>ls --color=auto&#39; [fuchencong@localhost Chapter_02]$ type grep grep is aliased to </code>grep –color&#x3D;auto’<br>通过使用 —color&#x3D;always 的方式强制总是输出颜色控制字符。最后通过 less 的 -R 选项根据原始的颜色控制符显示颜色。</p>
<p>通过管道使用 grep 时保留色彩<br>命令<br>1<br>$ ls -l –color&#x3D;always | grep –color&#x3D;nerver string<br>作用<br>通过上述方式，使用 grep 过滤 ls 命令的结果时，仍然能够保留 ls 命令的颜色高亮，而不是使用 grep 自己的颜色高亮机制。</p>
<p>例子<br>1<br>[fuchencong@localhost Chapter_02]$ ls -l &#x2F;etc&#x2F; | grep system</p>
<p>1<br>[fuchencong@localhost Chapter_02]$ ls -l –color&#x3D;always &#x2F;etc | grep –color&#x3D;never system</p>
<p>解释<br>在使用 ls 命令时，通过指定 —color&#x3D;always 选项，可以将颜色控制符输出到管道中。而 grep 的默认颜色高亮机制会对匹配字符串进行高亮，通过使用 —color&#x3D;never 机制忽略掉 grep 本色的颜色高亮机制，从而使用 ls 的颜色控制字符。</p>
<p>使用 sudo 用户权限向文件中添加内容<br>命令<br>1<br>$ echo text | sudo tee -a file<br>作用<br>通过上述方式，可以以 sudo 用户权限向 file 中添加内容。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_02]$ sudo echo “PRODUCTION Environment” &gt;&gt; &#x2F;etc&#x2F;motd<br>-bash: &#x2F;etc&#x2F;motd: Permission denied<br>[fuchencong@localhost Chapter_02]$ echo “PRODUCTION Environment” | sudo tee -a &#x2F;etc&#x2F;motd<br>PRODUCTION Environment<br>[fuchencong@localhost Chapter_02]$ tail -n 1 &#x2F;etc&#x2F;motd<br>PRODUCTION Environment<br>解释<br>如果想以其他用户的权限向 file 文件添加内容，sudo echo text &gt;&gt; file 的方式无法工作。因为该命令中，echo 命令将以 root 权限执行，而不是重定向符。所以通过 sudo tee 的方式将以 root 权限执行 tee 命令。tee 命令读取标准输入，并同时输出到标准输出和文件。-a 选项将以添加方式修改文件，而不是默认的覆写方式。</p>
<p>修改字符串的大小写<br>命令<br>1<br>2<br>$ tr [:upper:] [:lower:]<br>$ tr [:lower:] [:upper]<br>作用<br>第一种方式可以将字符串中的大写字符替换为小写。第二种方式可以将字符串中的小写字符替换为大写。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_02]$ echo “this is a TEST String” | tr [:upper:] [:lower:]<br>this is a test string<br>[fuchencong@localhost Chapter_02]$ echo “this is a TEST String” | tr [:lower:] [:upper:]<br>THIS IS A TEST STRING<br>解释<br>tr 命令用于替换字符串中的字符，[:upper:] 代表所有的大写字符， [:lower:] 代表所有的小写字符。除此之外。还可以用 A-Z 代表所有大写字符，a-z 代表所有小写字符。</p>
<p>以可读方式显示你的命令搜索路径（PATH 环境变量）<br>命令<br>1<br>$ echo $PATH | tr ‘:’ ‘\n’<br>作用<br>通过上述方式，可以以更加可读的方式查看 PATH 环境变量的值。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>[fuchencong@localhost Chapter_02]$ echo $PATH | tr ‘:’ ‘\n’<br>&#x2F;opt&#x2F;rh&#x2F;rh-ruby23&#x2F;root&#x2F;usr&#x2F;local&#x2F;bin<br>&#x2F;opt&#x2F;rh&#x2F;rh-ruby23&#x2F;root&#x2F;usr&#x2F;bin<br>&#x2F;usr&#x2F;local&#x2F;bin<br>&#x2F;bin<br>&#x2F;usr&#x2F;bin<br>&#x2F;usr&#x2F;local&#x2F;sbin<br>&#x2F;usr&#x2F;sbin<br>&#x2F;home&#x2F;fuchencong&#x2F;.local&#x2F;bin<br>&#x2F;home&#x2F;fuchencong&#x2F;bin<br>解释<br>PATH 环境变量中的路径字符串之间以 : 分割，这种方式不利于人类阅读。通过使用 tr 命令，将 : 替换为换行符，从而方便我们查看。</p>
<p>不使用编辑器创建一个文本文件<br>命令<br>1<br>2<br>3<br>$ cat &gt; output.file<br>…….<br><ctrl-d><br>作用<br>通过上述方式，可以创建 output.file 文件，而文件内容则为你在标准输入中输入的内容，通过输入文件结束符 <ctrl-d> 结束输入。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[fuchencong@localhost Chapter_02]$ cat &gt; shopping.list<br>milk<br>sugar<br>eggs<br>[fuchencong@localhost Chapter_02]$<br>[fuchencong@localhost Chapter_02]$ cat shopping.list<br>milk<br>sugar<br>eggs<br>解释<br>cat 命令是 concatenate 的简写，即 cat 命令可用于连接文件或标准输入的内容，并将其输出到标准输出。这里通过 cat 命令以及重定向操作符将标准输入的内容重定向到指定文件，从而把输入内容添加都新创建的文件中，而无需使用编辑器。</p>
<p>显示两个字符串之间的文本块<br>命令<br>1<br>$ awk ‘&#x2F;start-pattern&#x2F;, &#x2F;stop-pattern&#x2F;‘ file.txt<br>作用<br>该命令可以显示 file.txt 文件中 start-pattern 与 stop-pattern 之间的文本块。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>[fuchencong@localhost Chapter_02]$ cat test.file<br>paragraph 1 start<br>this is contents of paragraph 1.<br>paragraph 1 end</p>
<p>paragraph 2 start<br>this is contents of paragraph 2.<br>paragraph 2 end</p>
<p>paragraph 3 start<br>this is contents of paragraph 3.<br>paragraph 3 end<br>[fuchencong@localhost Chapter_02]$ awk ‘&#x2F;paragraph 2 start&#x2F;, &#x2F;paragraph 2 end&#x2F;‘ test.file<br>paragraph 2 start<br>this is contents of paragraph 2.<br>paragraph 2 end<br>解释<br>grep 命令适合单行文本上的过滤，如果想要获取一段文本块，可以使用 awk 的模式匹配进行实现，通过上述方式，可以显示 start-pattern 与 stop-pattern 之间的文本块。模式可以是简单的字符串，也可以是正则表达式。</p>
<p>删除两个字符串之间的文本<br>命令<br>1<br>sed ‘&#x2F;start-pattern&#x2F;, &#x2F;stop-pattern&#x2F;d’ file<br>作用<br>通过上述命令，可以删除 file 文件中以 start-pattern 模式到 stop-pattern 模式之间的文本快。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>[fuchencong@localhost Chapter_02]$ cat test.file<br>paragraph 1 start<br>this is contents of paragraph 1.<br>paragraph 1 end</p>
<p>paragraph 2 start<br>this is contents of paragraph 2.<br>paragraph 2 end</p>
<p>paragraph 3 start<br>this is contents of paragraph 3.<br>paragraph 3 end<br>[fuchencong@localhost Chapter_02]$ sed ‘&#x2F;paragraph 1 start&#x2F;, &#x2F;paragraph 2 end&#x2F;d’ test.file</p>
<p>paragraph 3 start<br>this is contents of paragraph 3.<br>paragraph 3 end<br>解释<br>该命令和上一个命令类似，都是对一段文本进行操作，这里通过 sed 的模式匹配查找以 start-pattern 和 stop-pattern 之间的文本块，并对其执行删除动作（d）。</p>
<p>通过 alias 解决常见拼写错误<br>命令<br>1<br>$ alias grpe&#x3D;”grep”<br>作用<br>如果在敲命令时通常犯同一个拼写错误，可以使用 alias 将拼写错误直接定义为正确命令的一个别名。这样下次即使拼写错误，也可以正常使用该命令。上面命令将 grpe 定义为 grep 的别名。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_02]$ grpe root &#x2F;etc&#x2F;passwd<br>-bash: grpe: command not found<br>[fuchencong@localhost Chapter_02]$ alias grpe&#x3D;”grep”<br>[fuchencong@localhost Chapter_02]$ grpe root &#x2F;etc&#x2F;passwd<br>root:x:0:0:root:&#x2F;root:&#x2F;bin&#x2F;bash<br>operator:x:11:0:operator:&#x2F;root:&#x2F;sbin&#x2F;nologin<br>解释<br>可以将该 alias 写入你的 bash 配置文件，这样该 alias 将会永久生效。只要你愿意，还可以为其他容易出现拼写错误的命令创建别名。</p>
<p>对输出的主体内容进行排序，同时保留第一行的表头<br>命令<br>1<br>2<br>3<br>4<br>5<br>body(){<br>    IFS&#x3D; read -r header<br>    printf ‘%s\n’ “$header”<br>    “$@”<br>}<br>作用<br>有时我们需要对包含表头的一段内容进行排序，此时我们希望只对主体内容进行排序，而仍然保持表头（第一行内容）原样地输出，可以通过上述函数实现该功能。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>[fuchencong@localhost Chapter_02]$ df -h | sort -k 5<br>devtmpfs                 476M     0  476M   0% &#x2F;dev<br>tmpfs                    488M     0  488M   0% &#x2F;dev&#x2F;shm<br>tmpfs                     98M     0   98M   0% &#x2F;run&#x2F;user&#x2F;0<br>tmpfs                    488M     0  488M   0% &#x2F;sys&#x2F;fs&#x2F;cgroup<br>&#x2F;dev&#x2F;sda1               1014M  130M  885M  13% &#x2F;boot<br>tmpfs                    488M  7.7M  480M   2% &#x2F;run<br>&#x2F;dev&#x2F;mapper&#x2F;centos-root   17G  9.4G  7.7G  55% &#x2F;<br>Filesystem               Size  Used Avail Use% Mounted on</p>
<p>[fuchencong@localhost Chapter_02]$ df -h | body sort -k 5 -n<br>Filesystem               Size  Used Avail Use% Mounted on<br>devtmpfs                 476M     0  476M   0% &#x2F;dev<br>tmpfs                    488M     0  488M   0% &#x2F;dev&#x2F;shm<br>tmpfs                    488M     0  488M   0% &#x2F;sys&#x2F;fs&#x2F;cgroup<br>tmpfs                     98M     0   98M   0% &#x2F;run&#x2F;user&#x2F;0<br>tmpfs                    488M  7.7M  480M   2% &#x2F;run<br>&#x2F;dev&#x2F;sda1               1014M  130M  885M  13% &#x2F;boot<br>&#x2F;dev&#x2F;mapper&#x2F;centos-root   17G  9.4G  7.7G  55% &#x2F;<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>[fuchencong@localhost Chapter_02]$ ps -eo pid,%cpu,cmd | sort -nrk 2 | head -n 5<br>   788  0.1 &#x2F;usr&#x2F;bin&#x2F;vmtoolsd<br>   PID %CPU CMD<br>   978  0.0 &#x2F;usr&#x2F;sbin&#x2F;NetworkManager –no-daemon<br>     9  0.0 [rcu_sched]<br>    89  0.0 [kauditd]</p>
<p>[fuchencong@localhost Chapter_02]$ ps -eo pid,%cpu,cmd | body sort -nrk 2 | head -n 5<br>   PID %CPU CMD<br>   788  0.1 &#x2F;usr&#x2F;bin&#x2F;vmtoolsd<br>   978  0.0 &#x2F;usr&#x2F;sbin&#x2F;NetworkManager –no-daemon<br>     9  0.0 [rcu_sched]<br>    89  0.0 [kauditd]<br>解释<br>body 是定义的一个 bash 函数，在该函数中首先通过 read 命令读取输入的第一行（即表头），保存到 header 变量中，然后通过 printf 输出该行内容。完成表头的处理后，再执行原始的命令（通过 $@ 实现）对剩余的输入内容进行处理。</p>
<p>从字符串中移除某个或某些字符<br>命令<br>1<br>2<br>$ cat file | tr -d “X”<br>$ cat file | tr -d [set]<br>作用<br>通过以上方式，可以从输出的字符串中删除某个特定字符或者某些字符。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>[fuchencong@localhost Chapter_02]$ cat test.file<br>“this is a test file.”<br>“use tr command, you can delete characters.”<br>“end of file.”<br>[fuchencong@localhost Chapter_02]$ cat test.file | tr -d ‘“‘<br>this is a test file.<br>use tr command, you can delete characters.<br>end of file.<br>[fuchencong@localhost Chapter_02]$ cat test.file | tr -d ‘“,.’<br>this is a test file<br>use tr command you can delete characters<br>end of file<br>解释<br>tr 命令通常用于替换字符，但是通过 -d 选项，tr 命令也可以用于删除字符。</p>
<p>统计一个字符串出现的次数<br>命令<br>1<br>$ command | uniq -c<br>作用<br>uniq 命令可以去除重复的行，通过 -c 选项，可以输出重复行的计数。但是需要注意，uniq 命令并不会首先检查整个文件的内容，而是只对邻接的行进行去重，所以通常 uniq 命令会配合 sort 命令使用。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_02]$ cat &#x2F;etc&#x2F;passwd | awk -F : ‘{print $NF}’ | sort | uniq -c | sort -nr<br>     19 &#x2F;sbin&#x2F;nologin<br>      4 &#x2F;bin&#x2F;bash<br>      1 &#x2F;sbin&#x2F;shutdown<br>      1 &#x2F;sbin&#x2F;halt<br>      1 &#x2F;bin&#x2F;sync<br>解释<br>以上命令首先获取 &#x2F;etc&#x2F;passwd&#x2F; 所有的登录 shell，通过 sort 命令首先进行排序，之后才能用 uniq -c 统计所有登录 shell 出现的次数，最后调用 sort -nr 根据出现次数进行逆序输出。</p>
<p>网络和 SSH<br>通过 Web 接口共享当前目录下的文件<br>命令<br>1<br>2<br>$ python -m SimpleHTTPServer<br>$ python3 -m http.server<br>作用<br>通过以上命令，可以通过 Web 方式共享当前目录下的文件。也就是说，其他用户通过浏览器访问你主机 IP 的 8000 端口，就可以访问你当前目录下的文件。</p>
<p>例子<br>1<br>2<br>[fuchencong@localhost Chapter_02]$ python -m SimpleHTTPServer<br>Serving HTTP on 0.0.0.0 port 8000 …<br>解释<br>以上命令会启动 Python 内置的一个 Web 服务器，并默认在 8000 端口上进行监听（可以在命令的最后指定监听的端口）。如果当前目录下没有 index.html 文件，那么访问 <a target="_blank" rel="noopener" href="http://hostip:8000/">http://HostIP:8000/</a> 将会列出当前目录的目录结构。所以其他用户可以通过访问该 URL 来浏览你目录下的文件。</p>
<p>通过 SSH 在你的主机上挂载远程服务器上的一个目录<br>命令<br>1<br>2<br>$ sshfs remote-host:&#x2F;directory mountpoint<br>$ fusermount -u mountpoint<br>作用<br>第一个命令用于挂载远程服务器上的目录，第二个命令用于取消挂载。</p>
<p>通过以上方式，可以在你的主机上挂载远程服务器的一个目录，这样就可以像操作本地目录一样操作远程服务器上的文件。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>[fuchencong@localhost ~]$ mkdir build_server<br>[fuchencong@localhost ~]$ ls -l build_server&#x2F;<br>total 0<br>[fuchencong@localhost ~]$ sshfs <a href="mailto:&#102;&#x63;&#104;&#101;&#110;&#x63;&#111;&#110;&#x67;&#64;&#x63;&#111;&#x6e;&#x74;&#114;&#x61;&#105;&#108;&#x2d;&#117;&#x62;&#x6d;&#x2d;&#115;&#114;&#x78;&#x2d;&#x72;&#x65;&#x33;&#x2e;&#99;&#99;&#112;&#46;&#x6a;&#117;&#110;&#x69;&#112;&#x65;&#114;&#x2e;&#x6e;&#x65;&#116;">&#102;&#x63;&#104;&#101;&#110;&#x63;&#111;&#110;&#x67;&#64;&#x63;&#111;&#x6e;&#x74;&#114;&#x61;&#105;&#108;&#x2d;&#117;&#x62;&#x6d;&#x2d;&#115;&#114;&#x78;&#x2d;&#x72;&#x65;&#x33;&#x2e;&#99;&#99;&#112;&#46;&#x6a;&#117;&#110;&#x69;&#112;&#x65;&#114;&#x2e;&#x6e;&#x65;&#116;</a>:&#x2F;&#x2F;homes&#x2F;fchencong build_server&#x2F;<br>fuchencong@localhost ~]$ ls -l build_server&#x2F;<br>total 584<br>drwxr-xr-x. 1 45444 935   4096 Mar 22 10:54 bin<br>drwxr-xr-x. 1 45444 935   4096 Oct 18 18:46 build<br>-rw-r–r–. 1 45444 935 572736 Nov  7 10:46 compare.tar.gz<br>-rwx——. 1 45060 707   1675 Nov 23 15:18 id_rsa<br>drwxr-xr-x. 1 45444 935   4096 Mar 22 10:53 pr<br>drwxr-xr-x. 1 45444 935   4096 Mar 20 10:39 private_image<br>drwxrwxrwx. 1 45444 935   4096 Feb 15 11:48 temp<br>[fuchencong@localhost ~]$ fusermount -u build_server&#x2F;<br>[fuchencong@localhost ~]$ ls -l build_server&#x2F;<br>total 0<br>解释<br>类似于 ssh 命令，可以使用 user@host 的形式指定登录远程服务器的用户名，如果不指定用户名，则默认为当前用户名。如果没有指定远程服务器的挂载目录，则默认为登录用户的 home 目录。</p>
<p>使用 curl 从命令行获取你的公有 IP<br>命令<br>1<br>$ curl ifconfig.me<br>作用<br>通常我们在局域网内使用私有 IP，在访问公网时通过 NAT 的方式获得一个公网 IP，使用该公网 IP 访问互连网的世界。可以通过以上方式，查取自己的公共 IP 地址。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost ~]$ curl ifconfig.me<br>116.197.188.11<br>[fuchencong@localhost ~]$ curl ifconfig.me&#x2F;ip<br>116.197.188.11<br>[fuchencong@localhost ~]$ curl ifconfig.me&#x2F;host<br>unavailable<br>解释<br>ifconfig.me 其实是个网站，通过 curl 命令访问该网站获取自己的 IP 信息。</p>
<p>使用 SSH 免密码登录远端主机<br>命令<br>1<br>2<br>3<br>$ ssh-keygen<br>$ ssh-copy-id remote-host<br>$ ssh remote-host<br>作用<br>通过以上方式，可以免密码地使用 SSH 登录到远端主机。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>[fuchencong@localhost ~]$ ssh-keygen<br>Generating public&#x2F;private rsa key pair.<br>Enter file in which to save the key (&#x2F;home&#x2F;fuchencong&#x2F;.ssh&#x2F;id_rsa):<br>Enter passphrase (empty for no passphrase):<br>Enter same passphrase again:<br>Your identification has been saved in &#x2F;home&#x2F;fuchencong&#x2F;.ssh&#x2F;id_rsa.<br>Your public key has been saved in &#x2F;home&#x2F;fuchencong&#x2F;.ssh&#x2F;id_rsa.pub.<br>The key fingerprint is:<br>SHA256:m1EQokepaYMU+C+EP9Hsei2uCwgFUAJ2w0lZdIgWhJg <a href="mailto:&#102;&#x75;&#99;&#104;&#x65;&#110;&#99;&#111;&#x6e;&#x67;&#64;&#x6c;&#111;&#x63;&#97;&#108;&#104;&#111;&#115;&#116;&#x2e;&#x6c;&#111;&#x63;&#97;&#x6c;&#100;&#111;&#109;&#x61;&#105;&#110;">&#102;&#x75;&#99;&#104;&#x65;&#110;&#99;&#111;&#x6e;&#x67;&#64;&#x6c;&#111;&#x63;&#97;&#108;&#104;&#111;&#115;&#116;&#x2e;&#x6c;&#111;&#x63;&#97;&#x6c;&#100;&#111;&#109;&#x61;&#105;&#110;</a><br>The key’s randomart image is:<br>+—[RSA 2048]—-+<br>|O&#x3D;BBBo+oo.       |<br>|E+o*.+o. .       |<br>| +o+.o.   .      |<br>|..&#x3D; B.   .       |<br>|.o &#x3D; .  S        |<br>|o + o    +       |<br>|o  + .  o        |<br>| .. o .          |<br>|  o&#x3D;..           |<br>+—-[SHA256]—–+<br>[fuchencong@localhost ~]$ ssh-copy-id <a href="mailto:&#102;&#x63;&#x68;&#x65;&#110;&#99;&#x6f;&#110;&#x67;&#64;&#99;&#x6f;&#x6e;&#x74;&#114;&#x61;&#x69;&#x6c;&#45;&#x75;&#98;&#109;&#x2d;&#x73;&#114;&#x78;&#x2d;&#x72;&#101;&#x33;&#x2e;&#99;&#99;&#112;&#x2e;&#x6a;&#117;&#110;&#105;&#x70;&#101;&#114;&#x2e;&#x6e;&#101;&#x74;">&#102;&#x63;&#x68;&#x65;&#110;&#99;&#x6f;&#110;&#x67;&#64;&#99;&#x6f;&#x6e;&#x74;&#114;&#x61;&#x69;&#x6c;&#45;&#x75;&#98;&#109;&#x2d;&#x73;&#114;&#x78;&#x2d;&#x72;&#101;&#x33;&#x2e;&#99;&#99;&#112;&#x2e;&#x6a;&#117;&#110;&#105;&#x70;&#101;&#114;&#x2e;&#x6e;&#101;&#x74;</a><br>&#x2F;bin&#x2F;ssh-copy-id: INFO: Source of key(s) to be installed: “&#x2F;home&#x2F;fuchencong&#x2F;.ssh&#x2F;id_rsa.pub”<br>&#x2F;bin&#x2F;ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed<br>&#x2F;bin&#x2F;ssh-copy-id: INFO: 1 key(s) remain to be installed – if you are prompted now it is to install the new keys<br><a href="mailto:&#x66;&#99;&#x68;&#x65;&#110;&#99;&#111;&#110;&#x67;&#x40;&#99;&#x6f;&#x6e;&#116;&#114;&#97;&#105;&#108;&#x2d;&#117;&#98;&#109;&#45;&#x73;&#x72;&#x78;&#x2d;&#114;&#101;&#51;&#46;&#x63;&#99;&#112;&#x2e;&#106;&#x75;&#x6e;&#105;&#x70;&#x65;&#x72;&#46;&#110;&#x65;&#x74;">&#x66;&#99;&#x68;&#x65;&#110;&#99;&#111;&#110;&#x67;&#x40;&#99;&#x6f;&#x6e;&#116;&#114;&#97;&#105;&#108;&#x2d;&#117;&#98;&#109;&#45;&#x73;&#x72;&#x78;&#x2d;&#114;&#101;&#51;&#46;&#x63;&#99;&#112;&#x2e;&#106;&#x75;&#x6e;&#105;&#x70;&#x65;&#x72;&#46;&#110;&#x65;&#x74;</a>‘s password:</p>
<p>Number of key(s) added: 1</p>
<p>Now try logging into the machine, with:   “ssh ‘<a href="mailto:&#102;&#99;&#x68;&#101;&#110;&#99;&#x6f;&#x6e;&#103;&#64;&#x63;&#x6f;&#110;&#x74;&#114;&#97;&#105;&#108;&#45;&#x75;&#98;&#x6d;&#x2d;&#x73;&#x72;&#120;&#x2d;&#x72;&#101;&#51;&#x2e;&#x63;&#x63;&#112;&#x2e;&#x6a;&#x75;&#110;&#x69;&#112;&#x65;&#x72;&#46;&#110;&#101;&#x74;">&#102;&#99;&#x68;&#101;&#110;&#99;&#x6f;&#x6e;&#103;&#64;&#x63;&#x6f;&#110;&#x74;&#114;&#97;&#105;&#108;&#45;&#x75;&#98;&#x6d;&#x2d;&#x73;&#x72;&#120;&#x2d;&#x72;&#101;&#51;&#x2e;&#x63;&#x63;&#112;&#x2e;&#x6a;&#x75;&#110;&#x69;&#112;&#x65;&#x72;&#46;&#110;&#101;&#x74;</a>‘“<br>and check to make sure that only the key(s) you wanted were added.<br>解释<br>为了免密码登录到远端主机，需要生成一对 SSH 密码对，包含一个公钥和一个私钥。ssh-keygen 完成以上工作，生成秘钥时可以对秘钥设置密码，如果无需指定密码，直接输入回车键即可。</p>
<p>在远端主机上，需要在其 ~&#x2F;.ssh&#x2F;authorized_keys 包含你的公钥，通过 ssh-copy-id 可以实现这一工作。</p>
<p>显示打开的网络连接<br>命令<br>1<br>$ sudo lsof -Pni<br>作用<br>该命令可以显示所有打开的网络连接。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[fuchencong@localhost Chapter_03]$ sudo lsof -Pni<br>COMMAND   PID       USER   FD   TYPE DEVICE SIZE&#x2F;OFF NODE NAME<br>sshd     1555       root    3u  IPv4  32748      0t0  TCP *:22 (LISTEN)<br>sshd     1555       root    4u  IPv6  32771      0t0  TCP *:22 (LISTEN)<br>master   1719       root   13u  IPv4  33537      0t0  TCP 127.0.0.1:25 (LISTEN)<br>master   1719       root   14u  IPv6  33538      0t0  TCP [::1]:25 (LISTEN)<br>sshd     4650       root    3u  IPv4  51061      0t0  TCP 192.168.204.100:22-&gt;192.168.204.1:51935 (ESTABLISHED)<br>sshd    11180       root    3u  IPv4 905674      0t0  TCP 192.168.204.100:22-&gt;192.168.204.1:53496 (ESTABLISHED)<br>python  11668 fuchencong    3u  IPv4 930470      0t0  TCP *:8000 (LISTEN)<br>解释<br>lsof 命令是 list open files 的简写，lsof 命令不仅可以用于显示打开的文件，还包括打开的端口以及网络连接。其中，-P 选项防止将端口号转化为服务名，-n 选项防止将 IP 地址转化为主机名，-i 选型告诉 lsof 列出所有的网络连接。</p>
<p>比较远端和本地文件的差异<br>命令<br>1<br>$ ssh remote-host cat &#x2F;path&#x2F;to&#x2F;remotefile | diff &#x2F;path&#x2F;to&#x2F;localfile -<br>作用<br>通过以上方式，可以比较远端主机上某个文件和本地文件系统中某个文件的差异。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>ssh cnrd-ngsrx-build08 cat &#x2F;etc&#x2F;passwd | diff &#x2F;etc&#x2F;passwd -<br>1c1<br>&lt; root:x:0:0:vsrx_yocto_ubuntu12:&#x2F;root:&#x2F;bin&#x2F;bash</p>
<hr>
<blockquote>
<p>root:x:0:0:jbm_ubuntu12:&#x2F;root:&#x2F;bin&#x2F;bash<br>17d16<br>……<br>解释<br>通过 ssh 连接到远端主机，并使用 cat filepath 的方式获取远端主机上某个文件的内容，然后通过管道传递给 diff 命令。diff 命令用于比较文件差异，在这个例子中，第一个参数是本地文件，第二个参数 - 用于表示标准输入，本例中也就是管道传入的内容。</p>
</blockquote>
<p>从命令行中发送邮件<br>命令<br>1<br>2<br>$ mail <a href="mailto:&#x72;&#x65;&#99;&#x69;&#x70;&#x69;&#x65;&#110;&#x74;&#x40;&#x64;&#x6f;&#x6d;&#x61;&#105;&#110;&#46;&#x63;&#111;&#x6d;">&#x72;&#x65;&#99;&#x69;&#x70;&#x69;&#x65;&#110;&#x74;&#x40;&#x64;&#x6f;&#x6d;&#x61;&#105;&#110;&#46;&#x63;&#111;&#x6d;</a><br>$ echo “message” | mail -s ‘subject’ <a href="mailto:&#114;&#101;&#x63;&#105;&#112;&#105;&#x65;&#110;&#116;&#x40;&#x64;&#111;&#109;&#x61;&#x69;&#110;&#x2e;&#99;&#x6f;&#x6d;">&#114;&#101;&#x63;&#105;&#112;&#105;&#x65;&#110;&#116;&#x40;&#x64;&#111;&#109;&#x61;&#x69;&#110;&#x2e;&#99;&#x6f;&#x6d;</a><br>作用<br>通过 mail 命令可以从命令行给指定邮箱发送邮件。</p>
<p>例子<br>1<br>[fuchencong@localhost ~]$ echo “this mail is from command line” | mail -s “Test mail” <a href="mailto:&#102;&#x63;&#x68;&#x65;&#x6e;&#x63;&#111;&#110;&#103;&#64;&#x6a;&#117;&#110;&#x69;&#x70;&#x65;&#114;&#x2e;&#110;&#101;&#116;">&#102;&#x63;&#x68;&#x65;&#x6e;&#x63;&#111;&#110;&#103;&#64;&#x6a;&#117;&#110;&#x69;&#x70;&#x65;&#114;&#x2e;&#110;&#101;&#116;</a></p>
<p>解释<br>可以从标准输入键入你的邮件内容（通过 Ctrl-d 结束输入）或者通过管道指定邮件内容，-s 选项可以指定邮件主题。</p>
<p>从命令行发送邮件附件<br>命令<br>1<br>$ mail -a &#x2F;path&#x2F;to&#x2F;attachment <a href="mailto:&#114;&#101;&#99;&#105;&#112;&#105;&#x65;&#x6e;&#x74;&#64;&#100;&#x6f;&#x6d;&#x61;&#x69;&#110;&#46;&#99;&#111;&#109;">&#114;&#101;&#99;&#105;&#112;&#105;&#x65;&#x6e;&#x74;&#64;&#100;&#x6f;&#x6d;&#x61;&#x69;&#110;&#46;&#99;&#111;&#109;</a><br>作用<br>通过上述命令，可以在命令行中向指定邮箱发送附件。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[fuchencong@localhost Chapter_03]$ script howto.txt<br>Script started, file is howto.txt<br>[fuchencong@localhost Chapter_03]$ ls<br>howto.txt<br>[fuchencong@localhost Chapter_03]$ touch new.file<br>[fuchencong@localhost Chapter_03]$ exit<br>exit<br>Script done, file is howto.txt<br>[fuchencong@localhost Chapter_03]$ echo “FYI” | mail -a howto.txt -s “how to create an empty file on Linux” <a href="mailto:&#x66;&#x63;&#x68;&#101;&#x6e;&#99;&#111;&#110;&#x67;&#x40;&#106;&#117;&#110;&#x69;&#112;&#101;&#114;&#46;&#x6e;&#101;&#x74;">&#x66;&#x63;&#x68;&#101;&#x6e;&#99;&#111;&#110;&#x67;&#x40;&#106;&#117;&#110;&#x69;&#112;&#101;&#114;&#46;&#x6e;&#101;&#x74;</a><br>解释<br>上面例子展示了一个我们经常会碰到的流程：如果我们需要告诉别人通过哪些命令完成某个任务，我们先在自己的 shell 上尝试，然后再将相应的命令发送给他人。这里首先使用 script 命令录制我们的尝试过程，并将其保存到 howto 这个文件中，最后通过 mail 命令 的 -a 选项发送该附件。</p>
<p>一气呵成，十分 geek。</p>
<p>创建 SSH 隧道访问远端资源<br>命令<br>1<br>$ ssh -N -L local-port:host:remote-port remote-host<br>作用<br>以上命令可以创建一个 SSH 隧道，-L 选项告诉 SSH 创建一个隧道，将会在本地主机打开第一个端口 local-port ，到该端口的所有连接都会通过隧道到达 remote-host，由 remote-host 将这些连接发送到 -L 选项中指定的 host:remote-port。-N 选项告诉 SSH 不要在远程主机上执行命令。</p>
<p>假设你有一个 Web 网站无法通过因特网访问，但是可以通过一个 server 访问该网站，同时你对该 server 有 SSH 权限。你可以创建一个隧道来访问该网站，就好像你在 Server 上访问该网站一样。</p>
<p>例子<br>1<br>2<br>$ ssh -N -L 8000:intranet.acme.com:80 jump-server &amp;<br>$ curl <a target="_blank" rel="noopener" href="http://localhost:8000/">http://localhost:8000</a><br>解释<br>通过以上方式，所以访问本地主机 8000 端口的连接都会通过隧道到达 jump-server，由 jumper-server 将这些连接发送给 intranet.acme.com 的 80 端口。所以访问本地主机的 8000 端口，其效果就等同于访问 intranet.acme.com 的 80 端口。</p>
<p>SSH 隧道的另一种用法是访问在服务器上运行的某种服务，而该服务器你有 SSH 权限。你可以在本地创建一个到该服务器的 SSH 隧道，之后通过访问本地的端口，就可以访问服务器上的相应服务。这个举个例子：</p>
<p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>fchencong@contrail-ubm-srx-re3:~$ python -m SimpleHTTPServer<br>Serving HTTP on 0.0.0.0 port 8000 …</p>
<p>▶ ssh -N -L 8000:localhost:8000 contrail-ubm-srx-re3.ccp.juniper.net<br>▶ curl <a target="_blank" rel="noopener" href="http://localhost:8000/">http://localhost:8000/</a><br><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"><html></p>
<title>Directory listing for /</title>
<body>
<h2>Directory listing for /</h2>
<hr>
<ul>
<li><a href=".bash_history">.bash_history</a>
<li><a href=".bash_profile">.bash_profile</a>
在该例子中，首先在服务器上启动一个 HTTP sever，监听端口为 8000。为了在我的 Mac 客户端上访问该 HTTP 服务，在我的 MAC 客户端上通过 ssh -N -L 8000:localhost:8000 contrail-ubm-srx-re3.ccp.juniper.net 创建了一个 SSH 隧道，这个隧道的含义是：在 Mac 客户端访问 8000 端口的连接将会通过隧道到达 contrail-ubm-srx-re3.ccp.juniper.net，由其将连接发送给 localhost:8000，这里的 localhost 是相对于 contrail-ubm-srx-re3.ccp.juniper.net ，也就是服务器本身。

<p>查找程序监听的端口<br>命令<br>1<br>$ netstat -nutlp<br>作用<br>通过以上方式，可以列出所有正在监听 tcp&#x2F;udp 端口的程序，以及所对应的监听端口</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[fuchencong@localhost Chapter_03]$ sudo netstat -nutlp<br>Active Internet connections (only servers)<br>Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID&#x2F;Program name<br>tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN      12519&#x2F;python<br>tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1555&#x2F;sshd<br>tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1719&#x2F;master<br>tcp6       0      0 :::22                   :::*                    LISTEN      1555&#x2F;sshd<br>tcp6       0      0 ::1:25                  :::*                    LISTEN      1719&#x2F;master<br>解释<br>netstat 命令可以用于显示网络连接，在该命令中，-n 选项显示数字形式的地址，而不是符号形式，-u 选项用于包括 UDP 协议，-t 选项用于包括 TCP 协议，-l 选项用于列出正在监听的 socket，-p选项打印出 pid 以及进程名。</p>
<p>对某一远程主机使用不同的 SSH key<br>命令<br>1<br>$ ssh -i ~&#x2F;.ssh&#x2F;id_rsa-remote-host<br>或者在 ~&#x2F;.ssh&#x2F;config 中添加如下配置：</p>
<p>1<br>2<br>Host remote-host<br>IdentityFile ~&#x2F;.ssh&#x2F;id_ras-remote-host<br>作用<br>如果针对不同的主机，你想使用不同的 SSH key，可以通过如上两种方式实现。第一种方式通过 ssh 的 -i 选项来显示指定 key。如果你不想每次都指定秘钥文件，可以在 ~&#x2F;.ssh&#x2F;config 中添加配置（即第二种方式）。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>$ cat ~&#x2F;.ssh&#x2F;config<br>    Host db1.example.com<br>    IdentityFile ~&#x2F;.ssh&#x2F;id_rsa-db1</p>
<p>$ cat ~&#x2F;.ssh&#x2F;config<br>    Host db*<br>    IdentityFile ~&#x2F;.ssh&#x2F;id_rsa-db1<br>    Host *.work.net<br>    IdentityFile ~&#x2F;work-files&#x2F;keys&#x2F;id_rsa</p>
<p>$ cat ~&#x2F;.ssh&#x2F;config<br>    Host *.example.com<br>    IdentityFile ~&#x2F;.ssh&#x2F;id_rsa-%h<br>解释<br>在 ~&#x2F;.ssh&#x2F;config 配置文件中，允许使用通配符。另外，%h 可以用于表示主机名，这样可以简化你的配置文件：不用每一个主机都添加一个配置项，%h 将自动扩展为相应 Host 中相应的主机名。</p>
<p>使用 SSH 建立连接时避免输入用户名<br>命令<br>在 ~&#x2F;.ssh&#x2F;config 中添加如下配置：</p>
<p>1<br>2<br>Host remote-host<br>User username<br>作用<br>如果在本地 Linux 主机上的用户名和远程服务器上的用户名不相同，在每次建立 SSH 连接时可以在主机名前通过 user@host 的方式显式指定登录用户名。但是为了避免每次都输入 username，可以在你的 ~&#x2F;.ssh&#x2F;config 文件中加入上述配置。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>▶ whoami<br>fchencong</p>
<p>~<br>▶ ssh 192.168.204.100<br><a href="mailto:&#102;&#117;&#99;&#104;&#x65;&#x6e;&#x63;&#111;&#x6e;&#x67;&#64;&#49;&#57;&#50;&#x2e;&#x31;&#x36;&#x38;&#x2e;&#50;&#x30;&#x34;&#46;&#49;&#48;&#x30;">&#102;&#117;&#99;&#104;&#x65;&#x6e;&#x63;&#111;&#x6e;&#x67;&#64;&#49;&#57;&#50;&#x2e;&#x31;&#x36;&#x38;&#x2e;&#50;&#x30;&#x34;&#46;&#49;&#48;&#x30;</a>‘s password:<br>Last login: Mon Apr  1 14:22:37 2019 from 192.168.204.1<br>[fuchencong@localhost ~]$ whoami<br>fuchencong<br>[fuchencong@localhost ~]$ exit<br>logout<br>Connection to 192.168.204.100 closed.<br>▶ cat ~&#x2F;.ssh&#x2F;config<br>Host 192.168.204.100<br>User fuchencong<br>解释<br>通过在 ~&#x2F;.ssh&#x2F;config 指定 User，这样即使本地主机的用户名和远程登录的用户名不相同，也无需每次都显式指定用户名。</p>
<p>简化多跳 SSH 连接<br>命令<br>在 ~&#x2F;.ssh&#x2F;config 文件中添加如下配置：</p>
<p>1<br>2<br>3<br>4<br>Host jumphost.example.com<br>ProxyCommand none<br>Host *.example.com<br>ProxyCommand ssh -W %h:%p jumphost.example.com<br>作用<br>如果你想访问位于中转服务器之后的主机，可以通过以上方式简化你的 SSH 连接建立过程。以上配置将告诉 SSH 自动通过中转服务器连接到目的主机。在你的本地主机上，直接输入 ssh destination-host 即可连接到目的主机，而无需首先连接到中转服务器，再由中转服务器连接到目的主机。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>▶ ssh fchencong@cnrd-ngsrx-build07<br>^C<br>▶ cat <del>&#x2F;.ssh&#x2F;config<br>Host cnrd-ngsrx-build07<br>ProxyCommand ssh -W %h:%p contrail-ubm-srx-re3.ccp.juniper.net<br>▶ ssh fchencong@cnrd-ngsrx-build07<br><a href="mailto:&#102;&#99;&#104;&#x65;&#110;&#99;&#x6f;&#110;&#x67;&#64;&#99;&#111;&#110;&#x74;&#114;&#97;&#105;&#x6c;&#x2d;&#117;&#x62;&#109;&#x2d;&#115;&#x72;&#x78;&#x2d;&#114;&#101;&#x33;&#46;&#99;&#x63;&#x70;&#46;&#x6a;&#117;&#x6e;&#x69;&#112;&#101;&#x72;&#x2e;&#x6e;&#101;&#x74;">&#102;&#99;&#104;&#x65;&#110;&#99;&#x6f;&#110;&#x67;&#64;&#99;&#111;&#110;&#x74;&#114;&#97;&#105;&#x6c;&#x2d;&#117;&#x62;&#109;&#x2d;&#115;&#x72;&#x78;&#x2d;&#114;&#101;&#x33;&#46;&#99;&#x63;&#x70;&#46;&#x6a;&#117;&#x6e;&#x69;&#112;&#101;&#x72;&#x2e;&#x6e;&#101;&#x74;</a>‘s password:<br>fchencong@cnrd-ngsrx-build07’s password:<br>fchencong@cnrd-ngsrx-build07:</del>$<br>解释<br>在上面这个例子中，我的 Mac 客户端无法直接访问 cnrd-ngsrx-build07，之后配置 SSH 代理，通过 contrail-ubm-srx-re3.ccp.juniper.net 中转到目的地，之后就可以直接在 Mac 客户端连接到最终的目的主机了。</p>
<p>SSH 会话断开重连后，继续之前的工作<br>命令<br>1<br>2<br>3<br>4<br>5<br>6<br>$ ssh remote-host<br>$ sreen<br>ctrl-a,d<br>$ exit<br>$ ssh remote-host<br>$ sreen -r<br>作用<br>当你需要在远程主机上执行一个长时间任务，为了避免由于网络连接中断而导致该任务中断，可以启动给一个 sreen 会话，在该 screen 会话中执行该长时间任务，之后即使你 detach 该 screen 会话，断开 SSH 连接，该任务仍然将继续执行。当你重新建立 SSH 连接并恢复该 screen 会话，还可以看到中间的执行结果。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>▶ ssh 192.168.204.100<br><a href="mailto:&#x66;&#x75;&#99;&#104;&#101;&#110;&#x63;&#111;&#x6e;&#x67;&#64;&#x31;&#57;&#50;&#46;&#49;&#54;&#x38;&#x2e;&#50;&#48;&#x34;&#x2e;&#49;&#48;&#48;">&#x66;&#x75;&#99;&#104;&#101;&#110;&#x63;&#111;&#x6e;&#x67;&#64;&#x31;&#57;&#50;&#46;&#49;&#54;&#x38;&#x2e;&#50;&#48;&#x34;&#x2e;&#49;&#48;&#48;</a>‘s password:<br>Last login: Mon Apr  1 14:34:41 2019 from 192.168.204.1<br>[fuchencong@localhost ~]$ screen</p>
<p>[fuchencong@localhost ~]$ while : ; do let var&#x3D;var+1; echo “var&#x3D;$var”; sleep 5; done<br>var&#x3D;1<br>var&#x3D;2<br>[detached from 12820.pts-2.localhost]<br>[fuchencong@localhost ~]$ exit<br>logout<br>Connection to 192.168.204.100 closed.<br>▶ ssh 192.168.204.100<br><a href="mailto:&#x66;&#117;&#x63;&#x68;&#x65;&#110;&#99;&#111;&#110;&#103;&#64;&#x31;&#x39;&#50;&#46;&#x31;&#x36;&#56;&#46;&#x32;&#x30;&#52;&#46;&#x31;&#x30;&#x30;">&#x66;&#117;&#x63;&#x68;&#x65;&#110;&#99;&#111;&#110;&#103;&#64;&#x31;&#x39;&#50;&#46;&#x31;&#x36;&#56;&#46;&#x32;&#x30;&#52;&#46;&#x31;&#x30;&#x30;</a>‘s password:<br>Last login: Mon Apr  1 17:08:00 2019 from 192.168.204.1<br>[fuchencong@localhost ~]$ screen -r<br>[fuchencong@localhost ~]$ while : ; do let var&#x3D;var+1; echo “var&#x3D;$var”; sleep 5; done<br>var&#x3D;1<br>var&#x3D;2<br>var&#x3D;3<br>var&#x3D;4<br>var&#x3D;5<br>解释<br>在该例子中，通过 SSH 连接到主机后，使用 screen 命令创建一个 screen 会话，在该 screen 会话中执行一个 while 循环命令，然后通过 ctrl-a d detach 该 screen 会话，这样即使之后断开 SSH 连接并重新连上，通过 screen -r 恢复该 screen 会话，命令始终在运行，且能看到中间的结果。如果中间结果超过了一个屏幕，你可以通过 ctrl-a ESC 的方式查看之前的结果，输入该命令后使用 vi 移动命令在输出结果中移动，最后输入 ESC 可以退出查看结果的模式。输入 exit 可以退出 screen 会话。</p>
<p>screen 是最常用的屏幕复用器，还有其它类似的工具：tmux，dtach，以及 byobu。</p>
<p>配置 SSH 基于模式在主机名后添加域名<br>命令<br>在 ~&#x2F;.ssh&#x2F;config 文件中添加如下配置：</p>
<p>1<br>2<br>Host host-prefix* !*.domain.com<br>HostName %h.domain.com<br>作用<br>有时在 SSH 某个主机时，为了避免输入完整的域名，一种方式是配置域名解析配置文件 &#x2F;etc&#x2F;resolv.conf，但是这种方式有一些限制。另一种方式就是配置 SSH 进行解析，在该配置中创建一个规则，对于所有以某个模式为前缀的主机名，都添加指定的域名，另外，对于那些已经有该域名的主机名，则不需要再添加域名。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>▶ ssh contrail-ubm-srx-re3<br>ssh: Could not resolve hostname contrail-ubm-srx-re3: nodename nor servname provided, or not known</p>
<p>▶ cat ~&#x2F;.ssh&#x2F;config<br>Host contrail* !*.ccp.juniper.net<br>HostName %h.ccp.juniper.net</p>
<p>▶ ssh  contrail-ubm-srx-re3<br><a href="mailto:&#102;&#99;&#104;&#101;&#110;&#x63;&#111;&#x6e;&#x67;&#x40;&#x63;&#111;&#x6e;&#x74;&#x72;&#x61;&#105;&#108;&#45;&#x75;&#x62;&#x6d;&#45;&#x73;&#x72;&#120;&#x2d;&#x72;&#x65;&#x33;&#x2e;&#x63;&#99;&#112;&#x2e;&#x6a;&#117;&#110;&#x69;&#x70;&#x65;&#114;&#46;&#110;&#101;&#116;">&#102;&#99;&#104;&#101;&#110;&#x63;&#111;&#x6e;&#x67;&#x40;&#x63;&#111;&#x6e;&#x74;&#x72;&#x61;&#105;&#108;&#45;&#x75;&#x62;&#x6d;&#45;&#x73;&#x72;&#120;&#x2d;&#x72;&#x65;&#x33;&#x2e;&#x63;&#99;&#112;&#x2e;&#x6a;&#117;&#110;&#x69;&#x70;&#x65;&#114;&#46;&#110;&#101;&#116;</a>‘s password:<br>fchencong@contrail-ubm-srx-re3:<del>$<br>fchencong@contrail-ubm-srx-re3:</del>$ hostname -f<br>contrail-ubm-srx-re3.svec.juniper.net<br>fchencong@contrail-ubm-srx-re3:~$ exit<br>logout<br>Connection to contrail-ubm-srx-re3.ccp.juniper.net closed.<br>解释<br>在这个例子中，直接输入不完全主机名，无法 SSH 成功，之后配置 ~&#x2F;.ssh&#x2F;config 文件，添加一个域名解析规则，只要是以 contrail 开头并且不以 ccp.juniper.net 结尾的主机名，都在其后面添加域名 ccp.juniper.net，之后使用 SSH 连接到该 FQDNs。</p>
<p>让任务在断开连接后仍然运行<br>命令<br>1<br>$ nohup command &amp;<br>作用<br>正常情况下，如果你在 bash 中后台运行一个任务，当你退出当前 shell 会话后该任务也会被终止。如果你想在你退出 shell 会话后该任务仍然继续保持运行，可以使用 nohup 命令。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>▶ ssh 192.168.204.100<br>Last login: Mon Apr  1 17:10:51 2019 from 192.168.204.1<br>[fuchencong@localhost ~]$ nohup find &#x2F; -name nosuch.file &amp;<br>[1] 13182<br>[fuchencong@localhost ~]$ nohup: ignoring input and appending output to ‘nohup.out’</p>
<p>[fuchencong@localhost ~]$ exit<br>logout<br>Connection to 192.168.204.100 closed.<br>▶ ssh 192.168.204.100<br>Last login: Mon Apr  1 19:53:45 2019 from 192.168.204.1<br>[fuchencong@localhost ~]$ cat nohup.out<br>find: ‘&#x2F;boot&#x2F;grub2’: Permission denied<br>find: ‘&#x2F;proc&#x2F;tty&#x2F;driver’: Permission denied<br>find: ‘&#x2F;proc&#x2F;1&#x2F;task&#x2F;1&#x2F;fd’: Permission denied<br>find: ‘&#x2F;proc&#x2F;1&#x2F;task&#x2F;1&#x2F;fdinfo’: Permission denied<br>find: ‘&#x2F;proc&#x2F;1&#x2F;task&#x2F;1&#x2F;ns’: Permission denied<br>……<br>解释<br>nohup 代表 no hang up，执行该命令后默认的输出保存在当前目录的 nohup.out 文件中，可以检查该文件获取命令的输出。</p>
<p>通过 SSH SOCKS 代理加密你的 Web 浏览数据<br>命令<br>1<br>$ ssh -D PORT remote-host<br>作用<br>当你在使用开放的无线热点时，为了对你的 Web 浏览数据进行加密，可以通过 SSH 隧道将浏览流量转发到远程主机上，由远程主机再将流量转发到目的主机。</p>
<p>例子<br>1<br>2<br>$ ssh -ND 1080 <a href="mailto:&#x75;&#x62;&#x75;&#x6e;&#x74;&#x75;&#64;&#116;&#101;&#115;&#x74;&#x2e;&#x63;&#x6f;&#x6d;&#x70;&#x75;&#x74;&#101;&#x72;&#x2d;&#49;&#46;&#97;&#x6d;&#97;&#122;&#x6f;&#x6e;&#97;&#119;&#115;&#x2e;&#99;&#x6f;&#109;">&#x75;&#x62;&#x75;&#x6e;&#x74;&#x75;&#64;&#116;&#101;&#115;&#x74;&#x2e;&#x63;&#x6f;&#x6d;&#x70;&#x75;&#x74;&#101;&#x72;&#x2d;&#49;&#46;&#97;&#x6d;&#97;&#122;&#x6f;&#x6e;&#97;&#119;&#115;&#x2e;&#99;&#x6f;&#109;</a><br>$ firefox <a target="_blank" rel="noopener" href="http://www.mybank.com/">http://www.mybank.com</a><br>解释<br>使用 ssh 的 -D 选项打开本地主机的的 PORT 端口，使用该端口进行代理连接。同时，由于只是使用端口转发，而并不需要真的登录到远程主机的 shell 执行命令，因此使用 -N 选项。然后配置你的 Web 浏览器，使用 SOCKS 5 proxy 协议，同时使用 localhost 作为 host，使用 PORT 作为端口。</p>
<p>从命令行下载 Web 网页、HTTP 数据或者使用 Web API<br>命令<br>1<br>2<br>$ curl -o file.html <a target="_blank" rel="noopener" href="http://website/webpage">http://website/webpage</a><br>$ wget <a target="_blank" rel="noopener" href="http://website/webpage">http://website/webpage</a><br>作用<br>curl 和 wget 命令都可以用于下载 Web 网页或者 Web 服务器上可下载的任何东西。也可以使用这些命令和 HTTP API 进行交互。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_03]$ curl -o baidu.index.html <a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a><br>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current<br>                                 Dload  Upload   Total   Spent    Left  Speed<br>100  2381  100  2381    0     0   6919      0 –:–:– –:–:– –:–:–  6941<br>[fuchencong@localhost Chapter_03]$ ls -l baidu.index.html<br>-rw-rw-r–. 1 fuchencong fuchencong 2381 Apr  2 11:44 baidu.index.html<br>解释<br>通过 curl 或 wget 命令就可以和 Web 服务器进行交互，而无需使用图形界面的浏览器。</p>
<p>Shell 脚本<br>命令行中创建 for 循环<br>命令<br>1<br>2<br>3<br>4<br>$ for VAR in LIST</p>
<blockquote>
<p>do</p>
<h1 id="use-VAR"><a href="#use-VAR" class="headerlink" title="use $VAR"></a>use $VAR</h1><p>done<br>1<br>$ for VAR in LIST; do use $VAR; done<br>作用<br>当你需要对一系列对象执行同样的操作，可以在 shell 中使用 for 循环实现这一点。在命令行中有两种输入循环方式，第一种由 bash 根据循环的语法自动提示你继续输入。第二种方式是直接在一行中输入整个 while 循环。</p>
</blockquote>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_04]$ for num in 1 2 3 4 5</p>
<blockquote>
<p>do<br>touch file_$num<br>done<br>[fuchencong@localhost Chapter_04]$ ls<br>file_1  file_2  file_3  file_4  file_5<br>1<br>2<br>3<br>[fuchencong@localhost Chapter_04]$ for num in 1 2 3 4 5; do rm file_$num; done<br>[fuchencong@localhost Chapter_04]$ ls<br>[fuchencong@localhost Chapter_04]$<br>解释<br>上面例子分别创建 5 个空文件，之后又删除这些文件。</p>
</blockquote>
<p>命令替换<br>命令<br>1<br>2<br>$ VAR&#x3D;<code>command</code><br>$ VAR&#x3D;$(command)<br>作用<br>以上两种方式都可以进行命令替换。第一种方式是更老的风格。命令替换的结果可以作为另一个命令的参数，或者赋值给变量等等。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[fuchencong@localhost Chapter_04]$ cp file file.<code>date +%F</code><br>[fuchencong@localhost Chapter_04]$ ls<br>file  file.2019-04-02<br>[fuchencong@localhost Chapter_04]$ for x in $(cut -d : -f 1 &#x2F;etc&#x2F;passwd); do groups $x; done<br>root : root docker<br>bin : bin<br>daemon : daemon<br>……<br>解释<br>以上例子展示了两种命令替换的用法。</p>
<p>将命令输出保存到变量中，方便之后使用<br>命令<br>1<br>2<br>3<br>4<br>5<br>$ for VAR in LIST</p>
<blockquote>
<p>VAR2&#x3D;$(command)<br>VAR3&#x3D;$(command)<br>echo “$VAR2 $VAR3”<br>done<br>作用<br>这里其实就是命令替换的一种常见用法，将命令的输出结果保存到变量中，这样之后就可以多次重用该命令的输出结果了。</p>
</blockquote>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[fuchencong@localhost Chapter_04]$ for USER in $(cut -f 1 -d : &#x2F;etc&#x2F;passwd)</p>
<blockquote>
<p>do<br> UID_MIN&#x3D;$(grep ^UID_MIN &#x2F;etc&#x2F;login.defs | awk ‘{print $NF}’)<br> USER_ID&#x3D;$(id -u $USER)<br>[ $USER_ID -gt $UID_MIN ] &amp;&amp; echo “user $USER, id $USER_ID”<br>done<br>user fuchencong, id 1001<br>user test2, id 1002<br>解释<br>该示例脚本显示了所有用户 id 大于 1000 的用户。</p>
</blockquote>
<p>从输入中每次读取一行<br>命令<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>$ while read LINE</p>
<blockquote>
<p>do</p>
<h1 id="Do-something-with-LINE"><a href="#Do-something-with-LINE" class="headerlink" title="Do something with $LINE"></a>Do something with $LINE</h1><p>done &lt; file.txt<br>$ command | while read LINE<br>do</p>
<h1 id="Do-something-with-LINE-1"><a href="#Do-something-with-LINE-1" class="headerlink" title="Do something with $LINE"></a>Do something with $LINE</h1><p>done<br>作用<br>如果你想从输入中每次读取一行，可以通过上述两种方式实现。第一种方式从文件中每次读取一行，第二种方式从 command 命令的输出中每次读取一行。</p>
</blockquote>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[fuchencong@localhost Chapter_04]$ df | grep [0-9]% | while read LINE</p>
<blockquote>
<p>do<br>use&#x3D;$(echo $LINE | awk ‘{print $5}’ | tr -d ‘%’)<br>mountpoint&#x3D;$(echo $LINE | awk ‘{print $6}’)<br>[ $use -gt 10 ] &amp;&amp; echo “$mountpoint usage is over 10%”<br>done<br>&#x2F; usage is over 10%<br>&#x2F;boot usage is over 10%<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>[fuchencong@localhost Chapter_04]$  df | grep [0-9]% | while read fs blocks used available use mountpoint<br>do<br>use&#x3D;$(echo $use | tr -d %)<br>[ $use -gt 10 ] &amp;&amp; echo “$mountpoint usage is over 10%”<br>done<br>&#x2F; usage is over 10%<br>&#x2F;boot usage is over 10%<br>解释<br>如果你想迭代一系列单词，每次读取其中一个，直接使用循环即可。如果你想每次迭代一行，则需要通过循环以及 read 命令实现。</p>
</blockquote>
<p>实例脚本读取 df 命令的输出，并进行解析，列出所有使用率超过 10% 的挂载点。第一种实现是在 while 循环内对每一行进行解析，第二种方式在读取每一行时直接将各个字段赋值给相应的变量。</p>
<p>接收用户输入并保存到变量中<br>命令<br>1<br>2<br>3<br>$ read VAR<br>$ read -n 1 VAR<br>$ read -p “Prompt text” VAR<br>作用<br>使用 read 命令可以从标准输入读入一整行内容并将其保存到变量中。可以使用 -n 选项来设置只读取指定个数的字符，使用 -p 选项可以输出提示字符串，以提醒用户输入。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>[fuchencong@localhost Chapter_04]$ cat read.sh<br>#!&#x2F;bin&#x2F;basn</p>
<h1 id="Copyright-C-fuchencong-com"><a href="#Copyright-C-fuchencong-com" class="headerlink" title="Copyright (C) fuchencong.com"></a>Copyright (C) fuchencong.com</h1><p>while true<br>do<br>    read -p “Which server would you like to backup? “ SERVER<br>    echo “Backing up $SERVER”<br>    read -p “Backup another server?(y&#x2F;n)” -n 1 BACKUP_AGAIN<br>    echo<br>    [ “$BACKUP_AGAIN” &#x3D; “y” ] || break<br>done</p>
<p>exit 0<br>[fuchencong@localhost Chapter_04]$ sh read.sh<br>Which server would you like to backup? server1<br>Backing up server1<br>Backup another server?(y&#x2F;n)y<br>Which server would you like to backup? server2<br>Backing up server2<br>Backup another server?(y&#x2F;n)n<br>解释<br>上述脚本展示了 read 的用法，从用户输入中读取内容并保存到变量中。</p>
<p>计算一段文本中某列的数字之和<br>命令<br>1<br>2<br>$ awk ‘{sum +&#x3D; $1} END {print sum}’ file<br>$ cat file | awk ‘{sum +&#x3D; $1} END {print sum}’<br>作用<br>通过上述方式，可以计算某一列的数字之和。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>[fuchencong@localhost Chapter_04]$ seq 10 15<br>10<br>11<br>12<br>13<br>14<br>15<br>[fuchencong@localhost Chapter_04]$ seq 10 15 | awk ‘{sum +&#x3D; $1} END {print sum}’<br>75<br>[fuchencong@localhost Chapter_04]$ df -mt tmpfs<br>Filesystem     1M-blocks  Used Available Use% Mounted on<br>tmpfs                488     0       488   0% &#x2F;dev&#x2F;shm<br>tmpfs                488    14       474   3% &#x2F;run<br>tmpfs                488     0       488   0% &#x2F;sys&#x2F;fs&#x2F;cgroup<br>tmpfs                 98     0        98   0% &#x2F;run&#x2F;user&#x2F;0<br>tmpfs                 98     0        98   0% &#x2F;run&#x2F;user&#x2F;1001<br>[fuchencong@localhost Chapter_04]$ df -mt tmpfs | awk ‘{sum +&#x3D; $3} END {print sum}’<br>14<br>解释<br>这里通过 awk 工具实现这一点，awk 对每一行执行 sum +&#x3D; $1，而 $1 就是该行中的第一列的值，将其加到变量 sum 中（初始值为 0）。对所有行处理完毕后，最后执行 END 中的语句，即输出 sum 变量的值。</p>
<p>向交互式命令自动回答 yes<br>命令<br>1<br>2<br>$ yes | command<br>$ yes “string” | command<br>作用<br>如果你在执行某个命令的过程中，需要用户输入 yes，可以尝试使用 yes 命令。yes 命令默认行为是一直输出字符 y，直至终止。可以通过yes string 的方式一直输出字符串 string。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[fuchencong@localhost Chapter_04]$  yes | while true; do read  answer; echo “answer is $answer”; [ “$answer” &#x3D; “y” ] || break; sleep 2; done<br>answer is y<br>answer is y<br>answer is y<br>answer is y<br>answer is y<br>answer is y<br>^C<br>解释<br>上述例子通过 yes 命令向 while 循环传递输入，可以看到 yes 命令默认输出的字符为 y，所以该 while 循环将会一直执行下去。</p>
<p>系统管理<br>以表格形式显示挂载的文件系统<br>命令<br>1<br>$ mount | column -t<br>作用<br>通过以上方式，可以以表格形式显示挂载的文件系统。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>[fuchencong@localhost Chapter_04]$ mount -t tmpfs<br>tmpfs on &#x2F;dev&#x2F;shm type tmpfs (rw,nosuid,nodev,seclabel)<br>tmpfs on &#x2F;run type tmpfs (rw,nosuid,nodev,seclabel,mode&#x3D;755)<br>tmpfs on &#x2F;sys&#x2F;fs&#x2F;cgroup type tmpfs (ro,nosuid,nodev,noexec,seclabel,mode&#x3D;755)<br>tmpfs on &#x2F;run&#x2F;user&#x2F;0 type tmpfs (rw,nosuid,nodev,relatime,seclabel,size&#x3D;99796k,mode&#x3D;700)<br>tmpfs on &#x2F;run&#x2F;user&#x2F;1001 type tmpfs (rw,nosuid,nodev,relatime,seclabel,size&#x3D;99796k,mode&#x3D;700,uid&#x3D;1001,gid&#x3D;1001)<br>[fuchencong@localhost Chapter_04]$ mount -t tmpfs | column -t<br>tmpfs  on  &#x2F;dev&#x2F;shm        type  tmpfs  (rw,nosuid,nodev,seclabel)<br>tmpfs  on  &#x2F;run            type  tmpfs  (rw,nosuid,nodev,seclabel,mode&#x3D;755)<br>tmpfs  on  &#x2F;sys&#x2F;fs&#x2F;cgroup  type  tmpfs  (ro,nosuid,nodev,noexec,seclabel,mode&#x3D;755)<br>tmpfs  on  &#x2F;run&#x2F;user&#x2F;0     type  tmpfs  (rw,nosuid,nodev,relatime,seclabel,size&#x3D;99796k,mode&#x3D;700)<br>tmpfs  on  &#x2F;run&#x2F;user&#x2F;1001  type  tmpfs  (rw,nosuid,nodev,relatime,seclabel,size&#x3D;99796k,mode&#x3D;700,uid&#x3D;1001,gid&#x3D;1001)<br>解释<br>mount 命令的输出结果并不容易阅读，这里通过管道将 mount 命令的输出传递给 column -t 命令，以表格的形式输出结果。</p>
<p>结束给定用户或给定程序的所有进程<br>命令<br>1<br>2<br>$ pkill -9 command<br>$ pkill -9 user command<br>作用<br>如果你需要结束给定程序的多个进程，可以使用 pkill 命令。如果想结束给定用户的所有进程，可以使用 pkill 命令的 -u 选项。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>[fuchencong@localhost Chapter_04]$ ps -ef | grep python | grep -v grep<br>root        846      1  0 Mar28 ?        00:00:01 &#x2F;usr&#x2F;bin&#x2F;python -Es &#x2F;usr&#x2F;sbin&#x2F;firewalld –nofork –nopid<br>root       1557      1  0 Mar28 ?        00:01:08 &#x2F;usr&#x2F;bin&#x2F;python -Es &#x2F;usr&#x2F;sbin&#x2F;tuned -l -P<br>fuchenc+ 128392  11253  0 11:18 pts&#x2F;1    00:00:00 python<br>fuchenc+ 128519 128491  0 11:19 pts&#x2F;3    00:00:00 python</p>
<p>[fuchencong@localhost Chapter_04]$ pkill -9 -u fuchencong python</p>
<p>[fuchencong@localhost Chapter_04]$ ps -ef | grep python | grep -v grep<br>root        846      1  0 Mar28 ?        00:00:01 &#x2F;usr&#x2F;bin&#x2F;python -Es &#x2F;usr&#x2F;sbin&#x2F;firewalld –nofork –nopid<br>root       1557      1  0 Mar28 ?        00:01:08 &#x2F;usr&#x2F;bin&#x2F;python -Es &#x2F;usr&#x2F;sbin&#x2F;tuned -l -P<br>解释<br>pkill 只会对那些与指定字段完全匹配的进程起作用。</p>
<p>重复一个命令，直至成功<br>命令<br>1<br>2<br>3<br>4<br>$ while true:</p>
<blockquote>
<p>do<br>command &amp;&amp; break<br>done<br>作用<br>当 command 命令执行成功后，将会执行 break 退出循环，否则继续循环执行 command。通过以上方式，可以循环执行 comand 命令，直至该命令执行成功。</p>
</blockquote>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>[fuchencong@localhost Chapter_04]$ while true</p>
<blockquote>
<p>do<br>ping -c 1 -W 1 remotehost &gt; &#x2F;dev&#x2F;null 2&gt;&amp;1 &amp;&amp; break<br>done; echo “remotehost is up at $(date)”<br>[fuchencong@localhost Chapter_04]$<br>解释<br>上述例子通过 ping 命令判断 remotehost 是否可达，如果不可达则持续等待，否则退出循环并打印 remotehost 变成可达状态的时间。</p>
</blockquote>
<p>查找谁占用的磁盘空间最多<br>命令<br>1<br>$ sudo du -s &#x2F;home&#x2F;* | sort -rn<br>作用<br>通过以上命令可以找出 &#x2F;home&#x2F; 目录下谁占用的磁盘空间最多。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_04]$ sudo du -s &#x2F;home&#x2F;* | sort -rn<br>508448	&#x2F;home&#x2F;ovs<br>144	&#x2F;home&#x2F;fuchencong<br>12	&#x2F;home&#x2F;test2<br>解释<br>还有一个图形界面工具 ncdu，可以更加直观地显示磁盘使用率。</p>
<p>查找占用磁盘空间最多的文件<br>命令<br>1<br>$ find &#x2F; -type -f -exec wc -c {} ; | sort -rn<br>作用<br>通过以上方式，可以从根目录开始查找占用磁盘空间最多的文件。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[fuchencong@localhost Chapter_04]$ sudo find ~ -type f -exec wc -c {} ; | sort -rn<br>46382 &#x2F;home&#x2F;fuchencong&#x2F;nohup.out<br>26398 &#x2F;home&#x2F;fuchencong&#x2F;.bash_history<br>2381 &#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_03&#x2F;baidu.index.html<br>1679 &#x2F;home&#x2F;fuchencong&#x2F;.ssh&#x2F;id_rsa<br>1011 &#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_01&#x2F;typescript<br>512 &#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_03&#x2F;howto.txt<br>414 &#x2F;home&#x2F;fuchencong&#x2F;.ssh&#x2F;id_rsa.pub<br>……<br>解释<br>使用 find 命令从指定目录开始查找，通过 -type 选项设置查找的目标为文件，对每个找到的文件执行 wc -c 命令，即统计该文件的字节数。然后通过 sort 命令根据数字进行逆序排序，从而找到占用磁盘空间最多的文件。</p>
<p>根据内存使用率排列进程<br>命令<br>1<br>$ ps aux | sort -rnk 4<br>作用<br>通过以上方式，可以根据内存使用率对所有进程进行排列。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>[fuchencong@localhost Chapter_04]$ ps aux  | sort -rnk 4 | more<br>root       1567  0.0  3.2 477252 32372 ?        Ssl  Mar28   3:21 &#x2F;usr&#x2F;bin&#x2F;containerd<br>root        846  0.0  2.9 357988 28964 ?        Ssl  Mar28   0:01 &#x2F;usr&#x2F;bin&#x2F;python -Es &#x2F;usr&#x2F;sbin&#x2F;firewalld –nofork –nopid<br>root       1557  0.0  1.7 573856 17132 ?        Ssl  Mar28   1:10 &#x2F;usr&#x2F;bin&#x2F;python -Es &#x2F;usr&#x2F;sbin&#x2F;tuned -l -P<br>……<br>解释<br>使用 ps aux 列出各个进程的详细信息，然后使用 sort 命令根据第 4 列的数字值进行逆序排列，从而列出内存占用最高的进程。</p>
<p>根据 CPU 使用率列出进程<br>命令<br>1<br>$ ps aux | sort -rnk 3<br>作用<br>通过以上方式，可以根据 CPU 使用率对所有进程进行排列。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_04]$ ps aux  | sort -rnk 3 | more<br>root        788  0.1  0.6 298728  6116 ?        Ssl  Mar28   9:05 &#x2F;usr&#x2F;bin&#x2F;vmtoolsd<br>root        978  0.0  1.2 628596 11988 ?        Ssl  Mar28   0:10 &#x2F;usr&#x2F;sbin&#x2F;NetworkManager –no-daemon<br>……<br>解释<br>使用 ps aux 列出各个进程的详细信息，然后使用 sort 命令根据第 3 列的数字值进行逆序排列，从而列出 CPU 使用率最高的进程。</p>
<p>获取系统是 32 位还是 64 位<br>命令<br>1<br>$ getconf LONG_BIT<br>作用<br>通过上述命令，可以快速检查自己的系统是 32 位 还是 64 位。</p>
<p>例子<br>1<br>2<br>[fuchencong@localhost ~]$ getconf LONG_BIT<br>64<br>解释<br>通过检查 LONG 整型所占用的位数，快速获得自己系统是 32 位还是 64 位。</p>
<p>创建一个随机密码<br>命令<br>1<br>2<br>$ openssl rand -base64 48 | cut -c1-PASSWORD_LENGTH<br>$ gpw() {openssl rand -base64 48 | cut -c1-${1};}<br>作用<br>可以使用上述方式创建一个随机密码。第一个命令随机产生指定 PASSWORD_LENGTH 的密码，第二个命令创建了一个函数，可以通过参数指定密码的长度。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost ~]$ echo ‘gpw() { openssl rand -base64 48 | cut -c1-${1}; }’ &gt;&gt; ~&#x2F;.bash_profile<br>[fuchencong@localhost ~]$ source ~&#x2F;.bash_profile<br>[fuchencong@localhost ~]$ gpw 6<br>2O&#x2F;VvU<br>[fuchencong@localhost ~]$ gpw 12<br>3fkqdzXcYCB3<br>解释<br>该例子将创建随机密码的函数写入 bash 配置文件，并通过 source 命令使其立即生效，之后就可以使用 gpw 创建指定长度的随机密码了。</p>
<p>文件和目录<br>快速创建文件的备份<br>命令<br>1<br>$ cp file{,.bak}<br>作用<br>可以使用大括号表达式快速创建一个文件的备份。大括号表达式允许你使用单个命令行参数创建出多个参数。例如 file{,.bak} 将会被扩展为两个参数 file 以及 file.bak ，file_{one,two,three} 将会被扩展为 file_one、file_two、file_three。大括号中的值可以是以逗号分隔的字符串，也可以是序列表达式，例如 {1..5} 或者 {a..z}。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>[fuchencong@localhost Chapter_05]$ cp test.file{,.bak}<br>[fuchencong@localhost Chapter_05]$ ls test.file*<br>test.file  test.file.bak<br>[fuchencong@localhost Chapter_05]$ touch file-{1,2,3}<br>[fuchencong@localhost Chapter_05]$ ls<br>file-1  file-2  file-3<br>[fuchencong@localhost Chapter_05]$ echo 10.0.0.{0..7}<br>10.0.0.0 10.0.0.1 10.0.0.2 10.0.0.3 10.0.0.4 10.0.0.5 10.0.0.6 10.0.0.7<br>解释<br>这里通过 Bash 中大括号表达式，快速创建文件的一个备份。</p>
<p>快速修改文件扩展名<br>命令<br>1<br>2<br>$ mv file{.old,.new}<br>$ mv file.{old,new}<br>作用<br>这里继续使用大括号语法，快速修改文件的扩展名，将其文件名从 file.old 修改为 file.new。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>[fuchencong@localhost Chapter_05]$ touch file.txt<br>[fuchencong@localhost Chapter_05]$ ls<br>file.txt<br>[fuchencong@localhost Chapter_05]$ mv file{.txt,.doc}<br>[fuchencong@localhost Chapter_05]$ ls<br>file.doc<br>[fuchencong@localhost Chapter_05]$ mv file.{doc,ppt}<br>[fuchencong@localhost Chapter_05]$ ls<br>file.ppt<br>[fuchencong@localhost Chapter_05]$ mv file{.ppt,}<br>[fuchencong@localhost Chapter_05]$ ls<br>file<br>解释<br>这里通过 Bash 中大括号表达式，快速修改文件扩展名。</p>
<p>根据日期创建文件的备份<br>命令<br>1<br>2<br>$ alias d&#x3D;’date +%F’<br>$ cp file file.<code>d</code><br>作用<br>通过上述方式，可以创建文件 file 的备份，备份文件的后缀名为当前日期。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>[fuchencong@localhost Chapter_05]$ alias d&#x3D;”date +%F”<br>[fuchencong@localhost Chapter_05]$ d<br>2019-04-04<br>[fuchencong@localhost Chapter_05]$ cp file file.<code>d</code><br>[fuchencong@localhost Chapter_05]$ ls<br>file  file.2019-04-04<br>[fuchencong@localhost Chapter_05]$ rm -rf file.2019-04-04<br>[fuchencong@localhost Chapter_05]$ cp file file.$(d)<br>[fuchencong@localhost Chapter_05]$ ls<br>file  file.2019-04-04<br>[fuchencong@localhost Chapter_05]$ rm -rf file.2019-04-04<br>[fuchencong@localhost Chapter_05]$ cp file{,$(d)}<br>[fuchencong@localhost Chapter_05]$ ls<br>file  file2019-04-04<br>解释<br>首先通过 alias 创建一个命令别名，然后创建文件备份时通过命令替换获得当前日期，并将结果字符串作为备份文件的后缀名。</p>
<p>覆盖文件的内容<br>命令<br>1<br>$ command &gt; file<br>作用<br>将 command 命令的输出结果写入到 file 文件中。如果 file 文件不存在，将创建一个文件，否则将覆写该文件的内容。</p>
<p>例子<br>1<br>2<br>3<br>[fuchencong@localhost Chapter_05]$ echo “this is a test file” &gt; file<br>[fuchencong@localhost Chapter_05]$ cat file<br>this is a test file<br>解释<br>通过重定向符 &gt; 将命令的输出写入指定文件。</p>
<p>清空文件的内容<br>命令<br>1<br>2<br>$ &gt; file<br>$ cat &#x2F;dev&#x2F;null &gt; file<br>作用<br>通过以上两种方式，都可以快速清空文件 file 的内容。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>[fuchencong@localhost Chapter_05]$ cat file<br>this is a test file<br>[fuchencong@localhost Chapter_05]$ &gt; file<br>[fuchencong@localhost Chapter_05]$ cat file<br>[fuchencong@localhost Chapter_05]$<br>解释<br>这里解释一下清空一个文件的内容与删除并重新创建该文件的区别。如果删除文件时，其他进程仍然保持了打开该文件的句柄，该文件所占用的磁盘空间并不会释放，只有当所有进程都释放了该文件对应的句柄，磁盘空间才会被释放。而清空一个文件则是直接删除该文件的内容，因此磁盘空间立即被释放。</p>
<p>在文件末尾添加字符串<br>命令<br>1<br>$ command &gt;&gt; file<br>作用<br>通过以上命令，可以将 command 命令的输出添加到 file 文件的末尾。如果文件不存在，将创建一个文件。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_05]$ cat file<br>this is line 1<br>[fuchencong@localhost Chapter_05]$ echo “this is line 2” &gt;&gt; file<br>[fuchencong@localhost Chapter_05]$ cat file<br>this is line 1<br>this is line 2<br>解释<br>通过重定向 &gt;&gt; 操作符，可以在 file 文件的末尾添加字符串。</p>
<p>查看动态增长的文件<br>命令<br>1<br>$ tail -f file<br>作用<br>通过以上命令，可以动态实时地查看一个文件更新的内容。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>[fuchencong@localhost Chapter_05]$ tail -f tmp.log<br>current value is 30<br>current value is 31<br>current value is 32<br>current value is 33<br>current value is 34<br>current value is 35<br>解释<br>通过 tail -f 可以查看实时查看文件末尾添加的内容。</p>
<p>同时监视多个 log 文件<br>命令<br>1<br>2<br>$ multitail file1 fileN<br>$ multitail file1 -I fileN<br>作用<br>通过使用 multitail 命令，可以同时监视多个动态变化的文件。而且 multitail 命令还支持高亮、过滤、合并以及其他功能。</p>
<p>例子<br>1<br>[fuchencong@localhost Chapter_05]$ multitail tmp1.log tmp2.log</p>
<p>解释<br>multitle 的 -I 选项允许将多个文件合并到一个窗口中进行监视，这种方式使得多个文件的输出将混合显示。这在 troubleshooting 时有时非常有用。</p>
<p>在使用 multitail 命令经常使用的一些命令：</p>
<p>F1：帮助<br>a：添加文件到视图中<br>d：从视图中删除文件<br>&#x2F;：搜索<br>ctrl-g：从命令、菜单或动作中退出<br>q：退出<br>删除空目录<br>命令<br>1<br>$ find . -type d -empty -delete<br>作用<br>通过上述方式，可以删除当前目录下的空目录。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>[fuchencong@localhost Chapter_05]$ mkdir empty_dir{1..5}<br>[fuchencong@localhost Chapter_05]$ ls<br>empty_dir1  empty_dir2  empty_dir3  empty_dir4  empty_dir5<br>[fuchencong@localhost Chapter_05]$ find . -type d -empty -delete<br>[fuchencong@localhost Chapter_05]$ ls<br>解释<br>通过 find 命令的 -type 选项查找目录，-empty 查找空目录，通过 -delete 选项对查找到的空目录执行删除动作。</p>
<p>打印包含给定字符串的文件列表<br>命令<br>1<br>$ grep -rl string .<br>作用<br>在当前目录下查找所有包含指定字符串的文件，并将其列出。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_05]$ grep -rl test .<br>.&#x2F;file.1<br>.&#x2F;file.2<br>.&#x2F;file.3<br>.&#x2F;file.4<br>.&#x2F;file.5<br>解释<br>通过 grep 命令进行模式查找，-r 选项用于递归查找，-l 选项列出匹配的文件名。</p>
<p>以可读方式递归列出目录结构<br>命令<br>1<br>$ find . -type f -ls<br>作用<br>通过以上方式，可以以更加可读的方式递归列出目录下的文件。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>[fuchencong@localhost Chapter_05]$ ls -lR<br>.:<br>total 20<br>drwxrwxr-x. 2 fuchencong fuchencong 76 Apr  4 17:22 dir<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:21 file.1<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:21 file.2<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:21 file.3<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:21 file.4<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:21 file.5</p>
<p>.&#x2F;dir:<br>total 20<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:22 file.1<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:22 file.2<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:22 file.3<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:22 file.4<br>-rw-rw-r–. 1 fuchencong fuchencong 20 Apr  4 17:22 file.5</p>
<p>[fuchencong@localhost Chapter_05]$ find . -type f -ls<br>34025643    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:21 .&#x2F;file.1<br>34025644    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:21 .&#x2F;file.2<br>34025645    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:21 .&#x2F;file.3<br>34025646    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:21 .&#x2F;file.4<br>34025647    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:21 .&#x2F;file.5<br>34025649    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:22 .&#x2F;dir&#x2F;file.1<br>34025650    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:22 .&#x2F;dir&#x2F;file.2<br>34025651    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:22 .&#x2F;dir&#x2F;file.3<br>34025652    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:22 .&#x2F;dir&#x2F;file.4<br>34025653    4 -rw-rw-r–   1 fuchencong fuchencong       20 Apr  4 17:22 .&#x2F;dir&#x2F;file.5<br>解释<br>尽管 ls 命令的 -R 选项也可以递归列出目录下的文件，但是其输出形式可读性不强。而且 find 命令同时会列出文件的路径。通过 find 命令的 的 -type 选项查找类型为 file 的文件，并使用 -ls 将其列出。</p>
<p>以树形结构列出文件和目录<br>命令<br>1<br>2<br>3<br>$ tree<br>$ tree -d<br>$ tree -L number<br>作用<br>通过以上方式，可以列出目录结构。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>[fuchencong@localhost Chapter_05]$ tree<br>.<br>├── dir<br>│   ├── file.1<br>│   ├── file.2<br>│   ├── file.3<br>│   ├── file.4<br>│   └── file.5<br>├── file.1<br>├── file.2<br>├── file.3<br>├── file.4<br>└── file.5</p>
<p>1 directory, 10 files<br>[fuchencong@localhost Chapter_05]$ tree -d<br>.<br>└── dir</p>
<p>1 directory<br>[fuchencong@localhost Chapter_05]$ tree -L 1<br>.<br>├── dir<br>├── file.1<br>├── file.2<br>├── file.3<br>├── file.4<br>└── file.5</p>
<p>1 directory, 5 files<br>解释<br>tree 命令可以以树形格式列出文件和目录。如果只想查看目录结构，可以列出 -d 选项。为了限制树的深度，可以使用 -L 选项并指定树的深度。</p>
<p>在多个文件中替换某个字符串<br>命令<br>1<br>$ find &#x2F;path -type f -exec sed -i.bak ‘s&#x2F;string&#x2F;replacement&#x2F;g’ {} ;<br>作用<br>通过以上方式，可以在指定目录下对多个文件实现字符串替换，将这些文件中的 string 替换为 replacement。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>[fuchencong@localhost Chapter_05]$ grep this -R *<br>file.1:this is a test line<br>file.2:this is a test line<br>file.3:this is a test line</p>
<p>[fuchencong@localhost Chapter_05]$ find . -type f -exec sed -i.bak ‘s&#x2F;this&#x2F;that&#x2F;g’ {} ;</p>
<p>[fuchencong@localhost Chapter_05]$ grep this -R *<br>file.1.bak:this is a test line<br>file.2.bak:this is a test line<br>file.3.bak:this is a test line<br>[fuchencong@localhost Chapter_05]$ grep that -R *<br>file.1:that is a test line<br>file.2:that is a test line<br>file.3:that is a test line<br>解释<br>通过 find 命令 在指定 &#x2F;path 下查找所有类型为 file 的文件，并对每一个找到的文件执行一个 sed 命令。该 sed 命令中的 -i.bak 用来指定直接在文件中进行替换，同时在替换之前创建当前文件的一个备份，备份文件的后缀为 .bak，s&#x2F;string&#x2F;replacement&#x2F;g 用于将文件中的所有 string 替换为 replacement。</p>
<p>从文件中获取指定行<br>命令<br>1<br>$ awk ‘NR&#x3D;&#x3D;N’<br>作用<br>通过上述命令，可以打印文件中指定的第 N 行。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>[fuchencong@localhost Chapter_05]$ cat test.file<br>this is line 1<br>this is line 2<br>this is line 3<br>this is line 4<br>this is line 5<br>this is line 6<br>this is line 7<br>this is line 8<br>this is line 9<br>this is line 10<br>[fuchencong@localhost Chapter_05]$ awk ‘NR&#x3D;&#x3D;6’ test.file<br>this is line 6<br>解释<br>通过 awk 实现打印文件中的第 N 行。</p>
<p>将文本文件在 Windows 格式 和 Linux 格式之间转换<br>命令<br>1<br>2<br>$ dos2unix<br>$ unix2dos<br>作用<br>Windows 格式的文本文件以 CR（carriage return）和 LF（line feed）作为行结束符，而 Linux 格式的文本文件以 LF（line feed）作为行结束符。有时候需要在这两种格式之间进行转换。dos2unix 命令可以将 Windows 格式的文本文件转换为 Linux 格式。unix2dos 命令可以将 Linux 格式的文本文件转换为 Windows 格式。</p>
<p>通过 cat -A 命令或者 file 命令检查行结束符。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>[fuchencong@localhost Chapter_05]$ cat -A test.file<br>this is line 1$<br>this is line 2$<br>this is line 3$<br>[fuchencong@localhost Chapter_05]$ file test.file<br>test.file: ASCII text<br>[fuchencong@localhost Chapter_05]$ unix2dos test.file<br>unix2dos: converting file test.file to DOS format …<br>[fuchencong@localhost Chapter_05]$ cat -A test.file<br>this is line 1^M$<br>this is line 2^M$<br>this is line 3^M$<br>[fuchencong@localhost Chapter_05]$ file test.file<br>test.file: ASCII text, with CRLF line terminators<br>[fuchencong@localhost Chapter_05]$ dos2unix test.file<br>dos2unix: converting file test.file to Unix format …<br>[fuchencong@localhost Chapter_05]$ cat -A test.file<br>this is line 1$<br>this is line 2$<br>this is line 3$<br>[fuchencong@localhost Chapter_05]$ file test.file<br>test.file: ASCII text<br>解释<br>有时候在 Linux 上创建的文本文件，在 Windows 上用记事本打开时可能所有内容都在一行上，所以需要在 Linux 上使用 unix2dos 命令将其先转换为 Windows 格式。</p>
<p>杂项<br>切换到上一个工作目录<br>命令<br>1<br>$ cd -<br>作用<br>通过以上方式，可以快速回到上一个工作目录。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>[fuchencong@localhost Chapter_05]$ pwd<br>&#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_05<br>[fuchencong@localhost Chapter_05]$ cd ..&#x2F;Chapter_04<br>[fuchencong@localhost Chapter_04]$ pwd<br>&#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_04<br>[fuchencong@localhost Chapter_04]$ cd -<br>&#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_05<br>[fuchencong@localhost Chapter_05]$ pwd<br>&#x2F;home&#x2F;fuchencong&#x2F;LearnProgramming&#x2F;Linux&#x2F;Command_KungFu&#x2F;Chapter_05<br>解释<br>OLDPWD 环境变量保存着你最近的一个工作目录的路径，使用 cd - 等同于 cd $OLDPWD</p>
<p>重置你的终端仿真器的显示<br>命令<br>1<br>$ reset<br>作用<br>通过以上方式，可以重置你的终端仿真器的显示。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_05]$ cat &#x2F;bin&#x2F;ls<br> ü¶­a¨ã¨¯a¨è°añ3a3@ ¶a¶<br> ……<br>[fuchencong@localhost Chapter_05]$reset<br>解释<br>如果一不小心在终端中显示了一个二进制文件，这会导致你的终端变得不可用。为了恢复你的终端，可以使用 reset 命令。</p>
<p>从命令行搜索维基百科<br>命令<br>1<br>2<br>$ dig +short txt <string>.wp.dg.cx<br>$ host -t txt <string>.wp.dg.cx<br>作用<br>如果有时候如果你想快速查找关于某个主题的信息，可以使用 DNS 来搜索维基百科。域名服务器会将维基百科的文章内容作为 TXT 格式返回。</p>
<p>例子<br>1<br>2<br>[fuchencong@localhost Chapter_05]$ dig +short txt unix.wp.dg.cx<br>;; connection timed out; no servers could be reached<br>解释<br>以上方式目前已经无法工作了，感觉原因是维基百科不再为每个词条创建相应的域名了。一种替代方式是使用 lynx 在命令行上浏览网页。</p>
<p>使非交互式会话和交互式会话行为一致<br>命令<br>1<br>2<br>3<br>4<br>5<br>将所有的自定义配置放入 ~&#x2F;.bashrc，然后 ~&#x2F;.bash_profile 的内容如下：</p>
<p>if [ -f ~&#x2F;.bashrc ]; then<br>    source ~&#x2F;.bashrc<br>fi<br>作用<br>如果你交互式方式登录到 shell 并执行一个命令，其行为可能和仅仅使用 ssh 连接到主机执行一个命令不一致。.profile 和 .bash_profile 中的配置内容只有在交互式会话启动时才会执行。所以最好将所有的自定义配置放入 .bashrc 文件中，然后在 ~&#x2F;.bash_profile 中仅仅引用 .bashrc 中的内容即可。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>30<br>31<br>[fuchencong@localhost ~]$ cat ~&#x2F;.bash_profile<br>ll() { ls -l; }<br>[fuchencong@localhost Chapter_05]$ ll<br>total 4<br>-rw-rw-r–. 1 fuchencong fuchencong 45 Apr  6 14:26 test.file<br>[fuchencong@localhost Chapter_05]$ ssh localhost ll<br>bash: ll: command not found<br>[fuchencong@localhost Chapter_05]$ cat ~&#x2F;.bash_profile</p>
<h1 id="bash-profile"><a href="#bash-profile" class="headerlink" title=".bash_profile"></a>.bash_profile</h1><h1 id="Get-the-aliases-and-functions"><a href="#Get-the-aliases-and-functions" class="headerlink" title="Get the aliases and functions"></a>Get the aliases and functions</h1><p>if [ -f ~&#x2F;.bashrc ]; then<br>    . ~&#x2F;.bashrc<br>fi</p>
<h1 id="User-specific-environment-and-startup-programs"><a href="#User-specific-environment-and-startup-programs" class="headerlink" title="User specific environment and startup programs"></a>User specific environment and startup programs</h1><p>[fuchencong@localhost Chapter_05]$ cat ~&#x2F;.bashrc</p>
<h1 id="bashrc"><a href="#bashrc" class="headerlink" title=".bashrc"></a>.bashrc</h1><h1 id="Source-global-definitions"><a href="#Source-global-definitions" class="headerlink" title="Source global definitions"></a>Source global definitions</h1><p>if [ -f &#x2F;etc&#x2F;bashrc ]; then<br>    . &#x2F;etc&#x2F;bashrc<br>fi</p>
<p>ll() { ls -l; }<br>[fuchencong@localhost Chapter_05]$ ssh localhost ll<br>fuchencong@localhost’s password:<br>total 48<br>drwxrwxr-x. 2 fuchencong fuchencong     6 Mar 31 16:03 build_server<br>drwxrwxr-x. 3 fuchencong fuchencong    19 Mar 28 14:24 LearnProgramming<br>-rw——-. 1 fuchencong fuchencong 46382 Apr  1 19:57 nohup.out<br>解释<br>最初，将 ll 命令定义在 ~&#x2F;.bash_profile 中，可以在交互式 shell 中使用，但是 ssh 直接调用该命令则无法生效。之后将该命令定义移动到 ~&#x2F;.bashrc，则两种场景都可以使用。</p>
<p>让你的电脑和你说话<br>命令<br>1<br>2<br>$ espeak -f file<br>$ echo text | espeak<br>作用<br>espeak 工具可以将文本转换为语音。可以为 espeak 工具提供一个文件，或者通过管道提供文本，espeak 将会将其转化为语音。</p>
<p>例子<br>1<br>[fuchencong@localhost Chapter_05]$ for i in {1..10}; do sleep 1; done; espeak “our job is done”<br>解释<br>可以在完成一个长时间的任务后，调用 espeak 工具输出一段语音提示。</p>
<p>显示不同时区下的当前时间<br>命令<br>1<br>$ TZ&#x3D;<TIMEZONE> date<br>作用<br>通过以上方式可以获得指定时区下的当前时间。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_05]$ TZ&#x3D;MST date<br>Sat Apr  6 04:57:38 MST 2019<br>[fuchencong@localhost Chapter_05]$ TZ&#x3D;Beijing date<br>Sat Apr  6 11:57:44 Beijing 2019<br>解释<br>通过 TZ 环境变量设置当前时区，通过 date 命令显示在该时区下的当前时间。</p>
<p>在命令行中显示日历<br>命令<br>1<br>2<br>3<br>$ cal<br>$ cal MM YYYYY<br>$ cal YYYY<br>作用<br>通过以上方式，可以在命令行中显示日历信息。第二种方式 cal MM YYYY 可以显示指定年指定月的日历信息。第三种方式 cal YYYY 可以显示指定年的日历信息。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>19<br>20<br>21<br>22<br>23<br>24<br>25<br>26<br>27<br>28<br>29<br>[fuchencong@localhost Chapter_05]$ cal<br>     April 2019<br>Su Mo Tu We Th Fr Sa<br>    1  2  3  4  5  6<br> 7  8  9 10 11 12 13<br>14 15 16 17 18 19 20<br>21 22 23 24 25 26 27<br>28 29 30<br>[fuchencong@localhost Chapter_05]$ cal 03 2019<br>     March 2019<br>Su Mo Tu We Th Fr Sa<br>                1  2<br> 3  4  5  6  7  8  9<br>10 11 12 13 14 15 16<br>17 18 19 20 21 22 23<br>24 25 26 27 28 29 30<br>31<br>[fuchencong@localhost Chapter_05]$ cal 2019<br>                               2019</p>
<pre><code>   January               February                 March
</code></pre>
<p>Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa   Su Mo Tu We Th Fr Sa<br>       1  2  3  4  5                   1  2                   1  2<br> 6  7  8  9 10 11 12    3  4  5  6  7  8  9    3  4  5  6  7  8  9<br>13 14 15 16 17 18 19   10 11 12 13 14 15 16   10 11 12 13 14 15 16<br>20 21 22 23 24 25 26   17 18 19 20 21 22 23   17 18 19 20 21 22 23<br>27 28 29 30 31         24 25 26 27 28         24 25 26 27 28 29 30<br>                                              31<br>……<br>解释<br>通过 cal 命令可以在命令行显示日历信息。</p>
<p>解压压缩文件到指定目录<br>命令<br>1<br>$ tar tarfile.tar -C &#x2F;path&#x2F;to&#x2F;extraction&#x2F;directory<br>作用<br>通过使用 tar 命令的 -C 选项，可以将压缩文件解压到指定目录中。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>[fuchencong@localhost Chapter_05]$ tar -xv -f test.tar -C dest_dir&#x2F;<br>test.file<br>[fuchencong@localhost Chapter_05]$ ls<br>dest_dir  test.tar<br>[fuchencong@localhost Chapter_05]$ ls dest_dir&#x2F; -l<br>total 4<br>-rw-rw-r–. 1 fuchencong fuchencong 45 Apr  6 14:26 test.file<br>解释<br>不用首先切换到指定目录，直接使用 tar 命令的 -C 选项就可以将压缩文件解压到指定目录中。</p>
<p>解压压缩文件时改变目录结构<br>命令<br>1<br>$ tar xf tarfile.tar –strip-components&#x3D;NUMBER<br>作用<br>如果你想从压缩文件中的某个子目录开始解压，可以使用 —strip-components 选项。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>[fuchencong@localhost Chapter_05]$ curl -sLO <a target="_blank" rel="noopener" href="https://github.com/twbs/bootstrap/archive/v3.4.1.tar.gz">https://github.com/twbs/bootstrap/archive/v3.4.1.tar.gz</a><br>[fuchencong@localhost Chapter_05]$ ls<br>v3.4.1.tar.gz<br>[fuchencong@localhost Chapter_05]$ tar -ztv -f v3.4.1.tar.gz  | head -n 1<br>drwxrwxr-x root&#x2F;root         0 2019-02-13 23:55 bootstrap-3.4.1&#x2F;<br>[fuchencong@localhost Chapter_05]$ tar -zxv -f v3.4.1.tar.gz –strip-components&#x3D;1 -C .&#x2F;bootstrap&#x2F;<br>bootstrap-3.4.1&#x2F;.editorconfig<br>bootstrap-3.4.1&#x2F;.gitattributes<br>……<br>[fuchencong@localhost Chapter_05]$ ls -l bootstrap&#x2F;<br>total 400<br>-rw-rw-r–.  1 fuchencong fuchencong    643 Feb 13 23:55 bower.json<br>-rw-rw-r–.  1 fuchencong fuchencong    434 Feb 13 23:55 CHANGELOG.md<br>-rw-rw-r–.  1 fuchencong fuchencong     17 Feb 13 23:55 CNAME<br>……<br>解释<br>例子中下载一个指定版本的压缩文件，该压缩文件的顶级目录是带版本号的目录，如果我们不想要该目录项，可以使用 —strip-components&#x3D;1 去除该顶级目录，然后通过 -C 选项将该目录下的所有文件解压到指定目录。</p>
<p>在命令行使用电子表格<br>命令<br>1<br>$ sc<br>作用<br>可以在命令行中使用电子表格程序 sc，sc 中的按键规则类似于 vi。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>root@92c4e480f92b:&#x2F;# sc<br>Do you want a chance to save the data?</p>
<pre><code>    A         B         C         D         E         F         G         H
</code></pre>
<p>  0      10.00<br>  1      20.00<br>  2<br>解释<br>这里我启用了一个 Docker Ubuntu 容器，然后通过 apt-get install sc 的方式安装了 sc 程序，对于其他发行版本，可能需要通过源码安装的方式进行安装。</p>
<p>简易版的命令行计时器<br>命令<br>1<br>$ time read<br>作用<br>通过以上方式可以创建一个简易版的命令行计时器，从输入命令后开始计时，再次输入回车键后结束计时，此时会打印出当前经过的时间。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_05]$ time read</p>
<p>real	0m4.863s<br>user	0m0.000s<br>sys	0m0.000s<br>解释<br>这是通过 time 命令实现的一个小技巧，time 命令用于计算一个程序运行的时间，这里 time read 用来计算 read 命令所消耗的时间，而 read 命令在读取到一行后就停止执行，time 命令也就会打印出这中间所经过的时间。</p>
<p>周期执行一个命令，并观察它的输出<br>命令<br>1<br>$ watch command<br>作用<br>通过以上方式，可以周期执行 command 命令，并输出其执行结果。默认的执行间隔为 2 s。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_05]$ watch free<br>Every 2.0s: free                                                                                                                               Sun Apr  7 14:31:30 2019</p>
<pre><code>          total        used        free	 shared  buff/cache   available
</code></pre>
<p>Mem:         997956	 326368      109976        7956      561612	 408596<br>Swap:       2097148        3868     2093280<br>解释<br>通过以上方式，就可以周期执行 free 命令，并根据其输出动态监视系统内存的变化情况。</p>
<p>在给定时间执行一个命令<br>命令<br>1<br>2<br>$ echo “command” | at time<br>$ at -f file time<br>作用<br>通过以上方式，可以在指定时间执行指定的命令。第一种方式直接指定命令，第二种方式将要执行的命令写入文件 file 中。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_05]$ echo “echo hello world” | at now +1minutes<br>job 3 at Sun Apr  7 14:44:00 2019<br>[fuchencong@localhost Chapter_05]$ atq<br>3	Sun Apr  7 14:44:00 2019 a fuchencong<br>解释<br>可以通过 atq 命令列出当前所设置的的 at 任务。通过 atrm 删除某个 at 任务。</p>
<p>和另一个用户共享你的 sceen 会话<br>命令<br>1<br>$ screen -x user&#x2F;session<br>作用<br>通过以上方式，可以共享 user&#x2F;session 这个 screen 会话。当一个 screen 会话被多方共享时，他们不仅可以看到同一个屏幕，还可以同时进行输入。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>[fuchencong@localhost Chapter_05]$ sudo chmod u+s &#x2F;usr&#x2F;bin&#x2F;screen<br>[fuchencong@localhost Chapter_05]$ sudo chmod 0755 &#x2F;var&#x2F;run&#x2F;screen&#x2F;<br>[fuchencong@localhost Chapter_05]$ screen -S for_test<br>ctrl-a :multiuser on<br>ctrl-a :acladd fuchencong</p>
<p>[fuchencong@localhost ~]$ screen -ls<br>There are screens on:<br>        110156.for_test (Attached)<br>1 Socket in &#x2F;var&#x2F;run&#x2F;screen&#x2F;S-fuchencong.<br>[fuchencong@localhost ~]$ screen -x for_test<br>解释<br>为了让 screen 工具支持多用户，screen 可执行程序必须设置 SUID 权限。然后当某人通过 screen -S 创建了一个 screen 会话，为了允许用户共享这个 screen 会话，输出 Ctrl-a 后，再输入 :multiuser on<enter>。为了允许某人连接到你的 session 会话，可以在输入 ctrl-a 后再输入 :acladd username。为了断开某人的会话连接，可以使用 :acldel username。</p>
<p>在允许他人连接到你的 screen 会话后，其他人就可以通过 screeen -x 的方式连接到指定的会话，会话可以由 PID 或者 name 指定。</p>
<p>对于一个命令别名执行其原始版本<br>命令<br>1<br>$ \aliased-command<br>作用<br>通过转义字符，可以使用该命令别名的原始版本，而不是对应的 alias 命令。</p>
<p>例子<br>1<br>2<br>3<br>4<br>5<br>6<br>[fuchencong@localhost Chapter_05]$ type ls<br>ls is aliased to &#96;ls -F’<br>[fuchencong@localhost Chapter_05]$ ls<br>bootstrap&#x2F;  sc&#x2F;  v3.4.1.tar.gz<br>[fuchencong@localhost Chapter_05]$ \ls<br>bootstrap  sc  v3.4.1.tar.gz<br>解释<br>可以看到，这里 ls 命令是 ls -F 的命令别名，这样就可以显示文件类型的后缀提示，直接输入 ls 是调用的命令别名版本，\ls 则调用原始命令。</p>
<p>将命令的结果保存为图像<br>命令<br>1<br>$ command | convert label:@-image.png<br>作用<br>通过以上方式，可以将命令的输出保存为图像格式。label 之后的 @ 符号告诉 convert 命令从后面指定的文件中读取内容，- 表示文件为标准输入，然后闯将名为 image.png 的图片。</p>
<p>例子<br>1<br>2<br>3<br>4<br>[fuchencong@localhost Chapter_05]$ echo “hello world” | convert label:@- test1.png<br>[fuchencong@localhost Chapter_05]$ convert label:”hello world” test2.png<br>[fuchencong@localhost Chapter_05]$ ls<br>test1.png  test2.png<br>解释<br>convert 工具是 ImageMagick 软件套件的一部分，所以首先需要安装该软件：sudo yum install ImageMagick。而且为了让上述例子生效，需要修改如下配置，将 &#x2F;etc&#x2F;ImageMagick&#x2F;policy.xml 中的如下行注释：</p>
<p>1<br><policy domain="coder" rights="none" pattern="LABEL" /></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/fuchencong.github.io/tags/Linux/" rel="tag"># Linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/fuchencong.github.io/2021/10/23/bash-hotkeys/" rel="prev" title="bash 快捷键总结">
      <i class="fa fa-chevron-left"></i> bash 快捷键总结
    </a></div>
      <div class="post-nav-item">
    <a href="/fuchencong.github.io/2021/10/24/coder-mac-01/" rel="next" title="程序员的 Mac（01）：效率神器 Alfred">
      程序员的 Mac（01）：效率神器 Alfred <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Shell-%E5%8E%86%E5%8F%B2"><span class="nav-number">1.</span> <span class="nav-text">Shell 历史</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8-root-%E8%B4%A6%E6%88%B7%E8%BF%90%E8%A1%8C%E4%B8%8A%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4"><span class="nav-number">1.1.</span> <span class="nav-text">使用 root 账户运行上一个命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4"><span class="nav-number">1.1.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8"><span class="nav-number">1.1.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90"><span class="nav-number">1.1.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A"><span class="nav-number">1.1.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%94%A8%E6%9C%80%E8%BF%91%E7%9A%84%E4%BB%A5%E7%BB%99%E5%AE%9A%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%BC%80%E5%A4%B4%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="nav-number">1.2.</span> <span class="nav-text">重用最近的以给定字符串开头的命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-1"><span class="nav-number">1.2.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-1"><span class="nav-number">1.2.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-1"><span class="nav-number">1.2.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-1"><span class="nav-number">1.2.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%94%A8%E4%B8%8A%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4%E7%9A%84%E7%AC%AC%E4%BA%8C%E4%B8%AA%E5%8D%95%E8%AF%8D%EF%BC%88%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%89"><span class="nav-number">1.3.</span> <span class="nav-text">重用上一个命令的第二个单词（第一个参数）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-2"><span class="nav-number">1.3.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-2"><span class="nav-number">1.3.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-2"><span class="nav-number">1.3.3.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%94%A8%E4%B8%8A%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%8D%95%E8%AF%8D%EF%BC%88%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%EF%BC%89"><span class="nav-number">1.4.</span> <span class="nav-text">重用上一个命令的最后一个单词（最后一个参数）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-3"><span class="nav-number">1.4.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-3"><span class="nav-number">1.4.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-2"><span class="nav-number">1.4.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-3"><span class="nav-number">1.4.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E7%94%A8%E4%BB%A5%E5%89%8D%E6%9F%90%E4%B8%AA%E5%91%BD%E4%BB%A4%E7%9A%84%E7%AC%AC-N-%E4%B8%AA%E5%8D%95%E8%AF%8D"><span class="nav-number">1.5.</span> <span class="nav-text">重用以前某个命令的第 N 个单词</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-4"><span class="nav-number">1.5.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-4"><span class="nav-number">1.5.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-3"><span class="nav-number">1.5.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-4"><span class="nav-number">1.5.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%A4%8D%E4%B8%8A%E4%B8%80%E4%B8%AA%E5%91%BD%E4%BB%A4%EF%BC%8C%E5%90%8C%E6%97%B6%E6%9B%BF%E6%8D%A2%E6%9F%90%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-number">1.6.</span> <span class="nav-text">重复上一个命令，同时替换某个字符串</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-5"><span class="nav-number">1.6.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-5"><span class="nav-number">1.6.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-4"><span class="nav-number">1.6.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-5"><span class="nav-number">1.6.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BC%95%E7%94%A8%E5%BD%93%E5%89%8D%E5%91%BD%E4%BB%A4%E7%9A%84%E6%9F%90%E4%B8%AA%E5%8D%95%E8%AF%8D"><span class="nav-number">1.7.</span> <span class="nav-text">引用当前命令的某个单词</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-6"><span class="nav-number">1.7.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-6"><span class="nav-number">1.7.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-5"><span class="nav-number">1.7.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-6"><span class="nav-number">1.7.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E5%91%BD%E4%BB%A4%E8%A1%8C%E4%BC%9A%E8%AF%9D%E7%9A%84%E5%89%AF%E6%9C%AC"><span class="nav-number">1.8.</span> <span class="nav-text">保存当前命令行会话的副本</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-7"><span class="nav-number">1.8.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-7"><span class="nav-number">1.8.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-6"><span class="nav-number">1.8.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-7"><span class="nav-number">1.8.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%BE%E5%87%BA%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="nav-number">1.9.</span> <span class="nav-text">找出最常用的命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-8"><span class="nav-number">1.9.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-8"><span class="nav-number">1.9.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-7"><span class="nav-number">1.9.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-8"><span class="nav-number">1.9.4.</span> <span class="nav-text">解释</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E7%A9%BA%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8E%86%E5%8F%B2"><span class="nav-number">1.10.</span> <span class="nav-text">清空命令行历史</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4-9"><span class="nav-number">1.10.1.</span> <span class="nav-text">命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8-9"><span class="nav-number">1.10.2.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BE%8B%E5%AD%90-8"><span class="nav-number">1.10.3.</span> <span class="nav-text">例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%A7%A3%E9%87%8A-9"><span class="nav-number">1.10.4.</span> <span class="nav-text">解释</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%92%8C%E6%93%8D%E4%BD%9C"><span class="nav-number">2.</span> <span class="nav-text">文本处理和操作</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#this-is-a-comment-line"><span class="nav-number"></span> <span class="nav-text">this is a comment line</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link"><span class="nav-number">1.</span> <span class="nav-text">Directory listing for &#x2F;</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#use-VAR"><span class="nav-number"></span> <span class="nav-text">use $VAR</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Do-something-with-LINE"><span class="nav-number"></span> <span class="nav-text">Do something with $LINE</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Do-something-with-LINE-1"><span class="nav-number"></span> <span class="nav-text">Do something with $LINE</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Copyright-C-fuchencong-com"><span class="nav-number"></span> <span class="nav-text">Copyright (C) fuchencong.com</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#bash-profile"><span class="nav-number"></span> <span class="nav-text">.bash_profile</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Get-the-aliases-and-functions"><span class="nav-number"></span> <span class="nav-text">Get the aliases and functions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#User-specific-environment-and-startup-programs"><span class="nav-number"></span> <span class="nav-text">User specific environment and startup programs</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#bashrc"><span class="nav-number"></span> <span class="nav-text">.bashrc</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Source-global-definitions"><span class="nav-number"></span> <span class="nav-text">Source global definitions</span></a></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fuchencong"
      src="/fuchencong.github.io/images/logo.jpeg">
  <p class="site-author-name" itemprop="name">fuchencong</p>
  <div class="site-description" itemprop="description">Having dreams is what makes life tolerable.</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/fuchencong.github.io/archives/">
        
          <span class="site-state-item-count">54</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/fuchencong.github.io/categories/">
          
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/fuchencong.github.io/tags/">
          
        <span class="site-state-item-count">19</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fuchencong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;fuchencong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:fuchencong@163.com" title="E-Mail → mailto:fuchencong@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fuchencong</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/fuchencong.github.io/lib/anime.min.js"></script>
  <script src="/fuchencong.github.io/lib/velocity/velocity.min.js"></script>
  <script src="/fuchencong.github.io/lib/velocity/velocity.ui.min.js"></script>

<script src="/fuchencong.github.io/js/utils.js"></script>

<script src="/fuchencong.github.io/js/motion.js"></script>


<script src="/fuchencong.github.io/js/schemes/muse.js"></script>


<script src="/fuchencong.github.io/js/next-boot.js"></script>




  















  

  

</body>
</html>
